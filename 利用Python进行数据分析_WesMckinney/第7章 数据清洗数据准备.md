# 处理缺失值
pd用NaN表示缺失值，np.nan，None均被当作NA  
**NA处理方法表**筛选，填充，判断
## 过滤缺失值
Series:  
    过滤缺失值，返回非缺与索引data.dropna()  
DataFrame:  
    data.dropna()删除缺失值行  
    data.dropna(how='all',axis=1)删除全缺失行/列  
    data.dropna(thresh=2)留含NA两行
## 补全缺失值
常数替代df.fillna(0)  
指定填充df.fillna({1: 0, 2: 1}, inplace=True)直接改原对象  
      df.fillna(method='ffill', limit=2)复制上一行，并且值搞两行  
填充统计值df.fillna(data.mean())  
**fillna函数的参数表**
# 7.2数据转换
## 删除重复
DataFrame：  
    检查哪行与前行重复：data.duplicated()  
    删除与前行重复行：  data.drop_duplicated()  
    data.drop_duplicated(['k1'], keep='last')基于k1列的重复情况删，保留最后一个
## 函数与映射
写旧列与新列的映射关系字典  
建立新键作列索引匹配该字典：data['animal'] = lowercased.map(meat_to_animal)
## 替代值
data.replace(-999, np.nan)旧替为新  
data.replace([-999, -1000], np.nan)同  
data.replace([-999, -1000], [np.nan, 0])指向替  
data.replace({-999:np.nan, -1000:0})字典形式
## 重命名轴索引
DataFrame：  
    行索引、前四行大写map：data.index.map(lambda x: x[:4].upper())  
    生成船新版本rename：  data.rename(index=str.title, columns=str.upper)  
                       data.rename(index={'1':'2'}, columns={'one':'two'}, inplace=True)  
                       行列索引指定改，指向旧对象
## 分箱与离散化
分箱：  
    pd.cut([0,2,10,22,88], [5,20,40,100], right=False, labels=['1','2','3']).codes，  
        前者分入后者各区间，返回所属区间列表Categorical对象  
                                          变为左开右封，对各区间制作箱名，打印内部数组（区间索引）  
    pd.cut(data, 4, precision=2)自动分为四个箱，十进制精度2  
    pd.qcut(data, 4)根据分位数分成内部等长的四个箱  
    pd.qcut(data, [0, 0.1, 0.5, 0.9])自定义分位数
## 检测过滤异常值
找大于3或小于-3:data[(np.abs(data)> 3).any(1)]  
根据正负生成1或-1:np.sign(data).head()
## 置换和随机抽样
df.take(np.random.permutation(5))行索引根据随机值重新排序  
df.sample(n=3)3行无替代随机子集  
df.sample(n=3, replace=True)3行含重复项子集
## 虚拟变量
一行单类生成虚拟矩阵：  
    pd.get_dummies(df['key'])列索引的唯一值，行值正确索引为1，否定为0  
    参数prefix='key'加前缀  
    df[['data1']].join(pd2)  pd的一列并入新pd  
一行多类：  
    通过唯一值，过滤出包含所有流派的列表  
    根据对象行长，列表长度构建全0DataFrame：np.zeros((len(movies), len(genres)))  
    ??????  
dummies与cut结合：  
    pd.get_dummies(pd.cut([1],[2]))列索引是列表2所分出的区间。先分箱，数组一的索引值为行，  
                                    数组索引与列区间匹配，在内为1否则为0
# 7.3 字符串操作
## 字符串对象的方法
val.split(',')根据符号拆开  
val.strip()去空格  
'::'.join(list)符号加入字符串列表的字符串之间，并使各字符串拼接  
val.find(',')定位字符串返回索引  
val.count(',')计算出现次数  
val.replace(',', '::')前为后替  
**字符串对象可用方法表**
## 正则
空白字符、re.compile('')编译了正则表达式的对象，regex.findall与search match的区别、  
**正则表达式方法表**
## 向量化字符串函数
str.contains('')检查是否含有  
data.str[:5]向量化切片  
**向量化字符串方法表**


```python
import numpy as np
```


```python
import pandas as pd
```


```python
string_data = pd.Series(['asdasd', 'safdsdf', np.nan, 'sdfsdf'])
```


```python
string_data
```




    0     asdasd
    1    safdsdf
    2        NaN
    3     sdfsdf
    dtype: object




```python
string_data.isnull()
```




    0    False
    1    False
    2     True
    3    False
    dtype: bool




```python
string_data[0] = None
```


```python
string_data.isnull()
```




    0     True
    1    False
    2     True
    3    False
    dtype: bool




```python
from numpy import nan as NA
```


```python
data = pd.Series([1, NA, 3.5, NA, 7])
```


```python
data.dropna()
```




    0    1.0
    2    3.5
    4    7.0
    dtype: float64




```python
data[data.notnull()]
```




    0    1.0
    2    3.5
    4    7.0
    dtype: float64




```python
data = pd.DataFrame([[1, 6., 3], [1, NA, NA],
                   [NA, NA, NA], [NA, 5, 3]])
```


```python
cleaned = data.dropna()
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
cleaned
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.dropna(how='all')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[4] = NA
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.dropna(axis=1, how='all')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df = pd.DataFrame(np.random.randn(7, 3))
```


```python
df.iloc[:4, 1] = NA
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.437774</td>
      <td>NaN</td>
      <td>1.416122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.026278</td>
      <td>NaN</td>
      <td>1.187288</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>NaN</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>NaN</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[:2, 2] = NA
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.437774</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.026278</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>NaN</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>NaN</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.dropna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.dropna(thresh=2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>NaN</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>NaN</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.fillna(0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.437774</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.026278</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>0.000000</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>0.000000</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.fillna({1: 0.5, 2: 0})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.437774</td>
      <td>0.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.026278</td>
      <td>0.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>0.500000</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>0.500000</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
_ = df.fillna(0, inplace=True)
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.437774</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.026278</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.844080</td>
      <td>0.000000</td>
      <td>-0.671074</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.275736</td>
      <td>0.000000</td>
      <td>2.117636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.414824</td>
      <td>0.187457</td>
      <td>0.104230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.063051</td>
      <td>-0.327047</td>
      <td>1.413764</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.071842</td>
      <td>0.603021</td>
      <td>-0.265335</td>
    </tr>
  </tbody>
</table>
</div>




```python
df = pd.DataFrame(np.random.randn(6, 3))
```


```python
df.iloc[2:, 1] = NA
```


```python
df.iloc[4:, 2] = NA
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.580203</td>
      <td>-0.710245</td>
      <td>0.932803</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.468588</td>
      <td>-0.240970</td>
      <td>-0.663667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.309309</td>
      <td>NaN</td>
      <td>1.445708</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.601004</td>
      <td>NaN</td>
      <td>0.038961</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.748053</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.428136</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.fillna(method='ffill')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.580203</td>
      <td>-0.710245</td>
      <td>0.932803</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.468588</td>
      <td>-0.240970</td>
      <td>-0.663667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.309309</td>
      <td>-0.240970</td>
      <td>1.445708</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.601004</td>
      <td>-0.240970</td>
      <td>0.038961</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.748053</td>
      <td>-0.240970</td>
      <td>0.038961</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.428136</td>
      <td>-0.240970</td>
      <td>0.038961</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.fillna(method='ffill', limit=2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.580203</td>
      <td>-0.710245</td>
      <td>0.932803</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.468588</td>
      <td>-0.240970</td>
      <td>-0.663667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.309309</td>
      <td>-0.240970</td>
      <td>1.445708</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.601004</td>
      <td>-0.240970</td>
      <td>0.038961</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.748053</td>
      <td>NaN</td>
      <td>0.038961</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.428136</td>
      <td>NaN</td>
      <td>0.038961</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.Series([1, NA, 3.5, NA, 7])
```


```python
data.fillna(data.mean())
```




    0    1.000000
    1    3.833333
    2    3.500000
    3    3.833333
    4    7.000000
    dtype: float64




```python
data = pd.DataFrame({'k1': ['one', 'two'] * 3 + ['two'],
                    'k2': [1, 1, 2, 3, 3, 4, 4]})
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.duplicated()
```




    0    False
    1    False
    2    False
    3    False
    4    False
    5    False
    6     True
    dtype: bool




```python
data.drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
data['v1'] = range(7)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop_duplicates(['k1'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop_duplicates(['k1', 'k2'], keep='last')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.DataFrame({'food': ['bacon', 'pulled pork', 'bacon',
                             'Pastrami', 'corned beef', 'Bacon',
                             'pastrami', 'honey ham', 'nova lox'],
                    'ounces': [4, 3, 12, 6, 7.5, 8, 3, 5, 6]})
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>ounces</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bacon</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pulled pork</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bacon</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pastrami</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>corned beef</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Bacon</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pastrami</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>honey ham</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>nova lox</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
meat_to_animal = {'bacon': 'pig', 'pulled pork': 'pig',
                 'pastrami': 'cow', 'corned beef': 'cow',
                 'honey ham': 'pig', 'nova lox': 'salmon'}
```


```python
lowercased = data['food'].str.lower()
```


```python
lowercased
```




    0          bacon
    1    pulled pork
    2          bacon
    3       pastrami
    4    corned beef
    5          bacon
    6       pastrami
    7      honey ham
    8       nova lox
    Name: food, dtype: object




```python
data['animal'] = lowercased.map(meat_to_animal)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>ounces</th>
      <th>animal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bacon</td>
      <td>4.0</td>
      <td>pig</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pulled pork</td>
      <td>3.0</td>
      <td>pig</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bacon</td>
      <td>12.0</td>
      <td>pig</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pastrami</td>
      <td>6.0</td>
      <td>cow</td>
    </tr>
    <tr>
      <th>4</th>
      <td>corned beef</td>
      <td>7.5</td>
      <td>cow</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Bacon</td>
      <td>8.0</td>
      <td>pig</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pastrami</td>
      <td>3.0</td>
      <td>cow</td>
    </tr>
    <tr>
      <th>7</th>
      <td>honey ham</td>
      <td>5.0</td>
      <td>pig</td>
    </tr>
    <tr>
      <th>8</th>
      <td>nova lox</td>
      <td>6.0</td>
      <td>salmon</td>
    </tr>
  </tbody>
</table>
</div>




```python
data['food'].map(lambda x: meat_to_animal[x.lower()])
```




    0       pig
    1       pig
    2       pig
    3       cow
    4       cow
    5       pig
    6       cow
    7       pig
    8    salmon
    Name: food, dtype: object




```python
data = pd.Series([1, -999, 2, -999, -1000, 3])
```


```python
data
```




    0       1
    1    -999
    2       2
    3    -999
    4   -1000
    5       3
    dtype: int64




```python
data.replace(-999, np.nan)
```




    0       1.0
    1       NaN
    2       2.0
    3       NaN
    4   -1000.0
    5       3.0
    dtype: float64




```python
data.replace([-999, -1000], np.nan)
```




    0    1.0
    1    NaN
    2    2.0
    3    NaN
    4    NaN
    5    3.0
    dtype: float64




```python
data.replace([-999, -1000], [np.nan, 0])
```




    0    1.0
    1    NaN
    2    2.0
    3    NaN
    4    0.0
    5    3.0
    dtype: float64




```python
data.replace({-999: np.nan, -1000: 0})
```




    0    1.0
    1    NaN
    2    2.0
    3    NaN
    4    0.0
    5    3.0
    dtype: float64




```python
data = pd.DataFrame(np.arange(12).reshape(3, 4),
                   index=['Ohio', 'Colorado', 'New York'],
                   columns=['one', 'two', 'three', 'four'])
```


```python
transform = lambda x: x[:4].upper()
```


```python
data.index.map(transform)
```




    Index(['OHIO', 'COLO', 'NEW '], dtype='object')




```python
data.index = data.index.map(transform)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>OHIO</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>COLO</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>NEW</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.rename(index=str.title, columns=str.upper)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ONE</th>
      <th>TWO</th>
      <th>THREE</th>
      <th>FOUR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colo</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>New</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.rename(index={'OHIO': 'INDIANA'},
           columns={'three': 'peekaboo'})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>peekaboo</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>INDIANA</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>COLO</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>NEW</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>OHIO</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>COLO</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>NEW</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.rename(index={'OHIO': 'INDIANA'}, inplace=True)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>INDIANA</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>COLO</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>NEW</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
ages = [20, 22, 25, 27, 21, 23, 37, 31, 61, 45, 41, 32]
```


```python
bins = [18, 25, 35, 60, 100]
```


```python
cats = pd.cut(ages, bins)
```


```python
cats
```




    [(18, 25], (18, 25], (18, 25], (25, 35], (18, 25], ..., (25, 35], (60, 100], (35, 60], (35, 60], (25, 35]]
    Length: 12
    Categories (4, interval[int64, right]): [(18, 25] < (25, 35] < (35, 60] < (60, 100]]




```python
cats.codes
```




    array([0, 0, 0, 1, 0, 0, 2, 1, 3, 2, 2, 1], dtype=int8)




```python
cats.categories
```




    IntervalIndex([(18, 25], (25, 35], (35, 60], (60, 100]], dtype='interval[int64, right]')




```python
pd.value_counts(cats)
```




    (18, 25]     5
    (25, 35]     3
    (35, 60]     3
    (60, 100]    1
    dtype: int64




```python
pd.cut(ages, [18, 26, 36, 61, 100], right=False)
```




    [[18, 26), [18, 26), [18, 26), [26, 36), [18, 26), ..., [26, 36), [61, 100), [36, 61), [36, 61), [26, 36)]
    Length: 12
    Categories (4, interval[int64, left]): [[18, 26) < [26, 36) < [36, 61) < [61, 100)]




```python
group_name = ['Youth', 'YoughAdult', 'MiddleAged', 'Senior']
```


```python
pd.cut(ages, bins, labels=group_name)
```




    ['Youth', 'Youth', 'Youth', 'YoughAdult', 'Youth', ..., 'YoughAdult', 'Senior', 'MiddleAged', 'MiddleAged', 'YoughAdult']
    Length: 12
    Categories (4, object): ['Youth' < 'YoughAdult' < 'MiddleAged' < 'Senior']




```python
data = np.random.rand(20)
```


```python
pd.cut(data, 4, precision=2)
```




    [(0.52, 0.76], (0.52, 0.76], (0.52, 0.76], (0.76, 1.0], (0.051, 0.29], ..., (0.76, 1.0], (0.29, 0.52], (0.29, 0.52], (0.76, 1.0], (0.76, 1.0]]
    Length: 20
    Categories (4, interval[float64, right]): [(0.051, 0.29] < (0.29, 0.52] < (0.52, 0.76] < (0.76, 1.0]]




```python
data = np.random.randn(1000)
```


```python
cats = pd.qcut(data, 4)
```


```python
cats
```




    [(0.00816, 0.694], (-3.407, -0.685], (0.694, 3.326], (0.00816, 0.694], (-3.407, -0.685], ..., (0.00816, 0.694], (-3.407, -0.685], (-0.685, 0.00816], (0.00816, 0.694], (-0.685, 0.00816]]
    Length: 1000
    Categories (4, interval[float64, right]): [(-3.407, -0.685] < (-0.685, 0.00816] < (0.00816, 0.694] < (0.694, 3.326]]




```python
pd.value_counts(cats)
```




    (-3.407, -0.685]     250
    (-0.685, 0.00816]    250
    (0.00816, 0.694]     250
    (0.694, 3.326]       250
    dtype: int64




```python
pd.qcut(data, [0, 0.1, 0.5, 0.9, 1.])
```




    [(0.00816, 1.313], (-3.407, -1.311], (1.313, 3.326], (0.00816, 1.313], (-1.311, 0.00816], ..., (0.00816, 1.313], (-3.407, -1.311], (-1.311, 0.00816], (0.00816, 1.313], (-1.311, 0.00816]]
    Length: 1000
    Categories (4, interval[float64, right]): [(-3.407, -1.311] < (-1.311, 0.00816] < (0.00816, 1.313] < (1.313, 3.326]]




```python
data = pd.DataFrame(np.random.randn(1000, 4))
```


```python
data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.012400</td>
      <td>-0.039975</td>
      <td>0.034355</td>
      <td>0.035496</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.976816</td>
      <td>1.004657</td>
      <td>0.976235</td>
      <td>0.992298</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.968628</td>
      <td>-3.157241</td>
      <td>-3.025925</td>
      <td>-2.786897</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.624594</td>
      <td>-0.735442</td>
      <td>-0.599919</td>
      <td>-0.698901</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.018467</td>
      <td>-0.035031</td>
      <td>-0.005805</td>
      <td>0.039614</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.650347</td>
      <td>0.637275</td>
      <td>0.676216</td>
      <td>0.716865</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.803814</td>
      <td>3.091770</td>
      <td>3.225493</td>
      <td>2.809190</td>
    </tr>
  </tbody>
</table>
</div>




```python
col = data[2]
```


```python
col
```




    0     -0.400237
    1      2.165733
    2      2.468687
    3      0.019783
    4      0.875847
             ...   
    995   -0.240552
    996   -0.981072
    997   -0.058433
    998    0.051503
    999    0.803227
    Name: 2, Length: 1000, dtype: float64




```python
col[np.abs(col) > 3]
```




    40     3.025749
    478    3.225493
    659   -3.025925
    Name: 2, dtype: float64




```python
data[(np.abs(data)> 3).any(1)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>0.017591</td>
      <td>0.429566</td>
      <td>3.025749</td>
      <td>-0.107455</td>
    </tr>
    <tr>
      <th>80</th>
      <td>3.803814</td>
      <td>1.200437</td>
      <td>0.245152</td>
      <td>-0.353789</td>
    </tr>
    <tr>
      <th>181</th>
      <td>-0.754723</td>
      <td>3.091770</td>
      <td>-0.831813</td>
      <td>0.447751</td>
    </tr>
    <tr>
      <th>257</th>
      <td>3.115948</td>
      <td>-2.164289</td>
      <td>-1.507857</td>
      <td>-0.513267</td>
    </tr>
    <tr>
      <th>260</th>
      <td>-0.641993</td>
      <td>-3.157241</td>
      <td>1.627398</td>
      <td>-0.906773</td>
    </tr>
    <tr>
      <th>397</th>
      <td>3.219699</td>
      <td>-0.141714</td>
      <td>0.408616</td>
      <td>0.293787</td>
    </tr>
    <tr>
      <th>416</th>
      <td>3.053990</td>
      <td>-0.513515</td>
      <td>-0.447009</td>
      <td>1.676579</td>
    </tr>
    <tr>
      <th>422</th>
      <td>1.327909</td>
      <td>3.066934</td>
      <td>1.283682</td>
      <td>0.683197</td>
    </tr>
    <tr>
      <th>478</th>
      <td>1.410908</td>
      <td>0.945432</td>
      <td>3.225493</td>
      <td>0.074439</td>
    </tr>
    <tr>
      <th>659</th>
      <td>-0.114073</td>
      <td>1.112886</td>
      <td>-3.025925</td>
      <td>-0.338842</td>
    </tr>
    <tr>
      <th>732</th>
      <td>3.237718</td>
      <td>1.667436</td>
      <td>-1.845694</td>
      <td>-0.882191</td>
    </tr>
    <tr>
      <th>888</th>
      <td>-0.206405</td>
      <td>-3.065594</td>
      <td>0.150879</td>
      <td>-1.167297</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[np.abs(data)>3] = np.sign(data) * 3
```


```python
data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.010969</td>
      <td>-0.039911</td>
      <td>0.034130</td>
      <td>0.035496</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.972028</td>
      <td>1.003498</td>
      <td>0.975363</td>
      <td>0.992298</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.968628</td>
      <td>-3.000000</td>
      <td>-3.000000</td>
      <td>-2.786897</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.624594</td>
      <td>-0.735442</td>
      <td>-0.599919</td>
      <td>-0.698901</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.018467</td>
      <td>-0.035031</td>
      <td>-0.005805</td>
      <td>0.039614</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.650347</td>
      <td>0.637275</td>
      <td>0.676216</td>
      <td>0.716865</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>2.809190</td>
    </tr>
  </tbody>
</table>
</div>




```python
np.sign(data).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df = pd.DataFrame(np.arange(5 * 4).reshape((5, 4)))
```


```python
sampler = np.random.permutation(5)
```


```python
sampler
```




    array([4, 3, 2, 1, 0])




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.take(sampler)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sample(n=3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
choices = pd.Series([5, 7, -1, 6, 4])
```


```python
draws = choices.sample(n=10, replace=True)
```


```python
draws
```




    2   -1
    1    7
    4    4
    1    7
    0    5
    0    5
    4    4
    3    6
    3    6
    2   -1
    dtype: int64




```python
df = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'b'],
                  'data1': range(6)})
```


```python
pd.get_dummies(df['key'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
dummies = pd.get_dummies(df['key'], prefix='key')
```


```python
df_with_dummy = df[['data1']].join(dummies)
```


```python
df_with_dummy
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>key_a</th>
      <th>key_b</th>
      <th>key_c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
mnames = ['movie_id', 'title', 'genres']
```


```python
movies = pd.read_table('datasets/movielens/movies.dat', sep='::',
                      header =None, names=mnames, engine='python')
```


```python
movies[:10]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Heat (1995)</td>
      <td>Action|Crime|Thriller</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>Sabrina (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>Tom and Huck (1995)</td>
      <td>Adventure|Children's</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>Sudden Death (1995)</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>GoldenEye (1995)</td>
      <td>Action|Adventure|Thriller</td>
    </tr>
  </tbody>
</table>
</div>




```python
all_genres = []
```


```python
for x in movies.genres:
    all_genres.extend(x.split('|'))
```


```python
genres = pd.unique(all_genres)
```


```python
genres
```




    array(['Animation', "Children's", 'Comedy', 'Adventure', 'Fantasy',
           'Romance', 'Drama', 'Action', 'Crime', 'Thriller', 'Horror',
           'Sci-Fi', 'Documentary', 'War', 'Musical', 'Mystery', 'Film-Noir',
           'Western'], dtype=object)




```python
zero_matrix = np.zeros((len(movies), len(genres)))
```


```python
dummies = pd.DataFrame(zero_matrix, columns=genres)
```


```python
gen = movies.genres[0]
```


```python
gen.split('|')
```




    ['Animation', "Children's", 'Comedy']




```python
dummies.columns.get_indexer(gen.split('|'))
```




    array([0, 1, 2])




```python
for i, gen in enumerate(movies.genres):
    indices = dummies.columns.get_indexer(gen.split('|'))
    dummies.iloc[i, indices] = 1
```


```python
movies_windic = movies.join(dummies.add_prefix('Genre_'))
```


```python
movies_windic.iloc[0]
```




    movie_id                                       1
    title                           Toy Story (1995)
    genres               Animation|Children's|Comedy
    Genre_Animation                              1.0
    Genre_Children's                             1.0
    Genre_Comedy                                 1.0
    Genre_Adventure                              0.0
    Genre_Fantasy                                0.0
    Genre_Romance                                0.0
    Genre_Drama                                  0.0
    Genre_Action                                 0.0
    Genre_Crime                                  0.0
    Genre_Thriller                               0.0
    Genre_Horror                                 0.0
    Genre_Sci-Fi                                 0.0
    Genre_Documentary                            0.0
    Genre_War                                    0.0
    Genre_Musical                                0.0
    Genre_Mystery                                0.0
    Genre_Film-Noir                              0.0
    Genre_Western                                0.0
    Name: 0, dtype: object




```python
np.random.seed(12345)
```


```python
values = np.random.rand(10)
```


```python
values
```




    array([0.92961609, 0.31637555, 0.18391881, 0.20456028, 0.56772503,
           0.5955447 , 0.96451452, 0.6531771 , 0.74890664, 0.65356987])




```python
bins = [0, 0.2, 0.4, 0.6, 0.8, 1]
```


```python
pd.get_dummies(pd.cut(values, bins))
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>(0.0, 0.2]</th>
      <th>(0.2, 0.4]</th>
      <th>(0.4, 0.6]</th>
      <th>(0.6, 0.8]</th>
      <th>(0.8, 1.0]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
val = 'a,b,  guido'
```


```python
val.split(',')
```




    ['a', 'b', '  guido']




```python
pieces = [x.strip() for x in val.split(',')]
```


```python
pieces
```




    ['a', 'b', 'guido']




```python
first, second, third = pieces
```


```python
first + '::' + second + '::' + third
```




    'a::b::guido'




```python
'::'.join(pieces)
```




    'a::b::guido'




```python
'guido' in pieces
```




    True




```python
val.index(',')
```




    1




```python
val.find(':')
```




    -1




```python
val.count(',')
```




    2




```python
val.replace(',', '::')
```




    'a::b::  guido'




```python
val.replace(',', '')
```




    'ab  guido'




```python
import re
```


```python
text = "foo bar\t baz \tqux"
```


```python
re.split('\s+', text)
```




    ['foo', 'bar', 'baz', 'qux']




```python
regex = re.compile('\s+')
```


```python
regex.split(text)
```




    ['foo', 'bar', 'baz', 'qux']




```python
regex.findall(text)
```




    [' ', '\t ', ' \t']




```python
text = """Dave dave@google.com
Steve steve@fmail.com
Rob rob@gmail.com
Ryan ryan@yahoo.com"""
```


```python
pattern = r'[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}'
```


```python
regex = re.compile(pattern, flags=re.IGNORECASE)
```


```python
regex.findall(text)
```




    ['dave@google.com', 'steve@fmail.com', 'rob@gmail.com', 'ryan@yahoo.com']




```python
m = regex.search(text)
```


```python
m
```




    <re.Match object; span=(5, 20), match='dave@google.com'>




```python
text[m.start():m.end()]
```




    'dave@google.com'




```python
print(regex.match(text))
```

    None



```python
print(regex.sub('REDACTED', text))
```

    Dave REDACTED
    Steve REDACTED
    Rob REDACTED
    Ryan REDACTED



```python
pattern = r'([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.([A-Z]{2,4})'
```


```python
regex = re.compile(pattern, flags=re.IGNORECASE)
```


```python
m = regex.match('wesm@bright.net')
```


```python
m.groups()
```




    ('wesm', 'bright', 'net')




```python
regex.findall(text)
```




    [('dave', 'google', 'com'),
     ('steve', 'fmail', 'com'),
     ('rob', 'gmail', 'com'),
     ('ryan', 'yahoo', 'com')]




```python
print(regex.sub(r'Username: \1, Domin: \2, Suffix: \3', text))
```

    Dave Username: dave, Domin: google, Suffix: com
    Steve Username: steve, Domin: fmail, Suffix: com
    Rob Username: rob, Domin: gmail, Suffix: com
    Ryan Username: ryan, Domin: yahoo, Suffix: com



```python
data = {'Dave': 'dave@google.com', 'Steve': 'steve@gmail.com',
       'Rob': 'rob@gmail.com', 'Wes': np.nan}
```


```python
data = pd.Series(data)
```


```python
data
```




    Dave     dave@google.com
    Steve    steve@gmail.com
    Rob        rob@gmail.com
    Wes                  NaN
    dtype: object




```python
data.isnull()
```




    Dave     False
    Steve    False
    Rob      False
    Wes       True
    dtype: bool




```python
data.str.contains('gmail')
```




    Dave     False
    Steve     True
    Rob       True
    Wes        NaN
    dtype: object




```python
pattern
```




    '([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\\.([A-Z]{2,4})'




```python
data.str.findall(pattern, flags=re.IGNORECASE)
```




    Dave     [(dave, google, com)]
    Steve    [(steve, gmail, com)]
    Rob        [(rob, gmail, com)]
    Wes                        NaN
    dtype: object




```python
x = data.str.findall(pattern, flags=re.IGNORECASE)
```


```python
x
```




    Dave     [(dave, google, com)]
    Steve    [(steve, gmail, com)]
    Rob        [(rob, gmail, com)]
    Wes                        NaN
    dtype: object




```python
x.str[0]
```




    Dave     (dave, google, com)
    Steve    (steve, gmail, com)
    Rob        (rob, gmail, com)
    Wes                      NaN
    dtype: object




```python
data.str[:5]
```




    Dave     dave@
    Steve    steve
    Rob      rob@g
    Wes        NaN
    dtype: object


