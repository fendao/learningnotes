```python
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import matplotlib as mpl
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS']
```


```python
# original_distribution由softmax生成一组概率值，temperature描述输出分布的熵，利用熵值对原始分布加权
def reweight_distribution(original_distribution, temperature=0.5):
    distribution = np.log(original_distribution) / temperature
    distribution = np.exp(distribution)
    return distribution / np.sum(distribution)
```

## 尼采风格


```python
import keras
import tensorflow
path = tensorflow.keras.utils.get_file(
    'nietzsche.txt',
    origin='https://s3.amazonaws.com/text-datasets/nietzsche.txt')
text = open(path).read().lower()
print('Corpus length:', len(text))
```

    Downloading data from https://s3.amazonaws.com/text-datasets/nietzsche.txt
    606208/600901 [==============================] - 42s 69us/step
    614400/600901 [==============================] - 42s 69us/step
    Corpus length: 600893



```python
# 60字符截断
maxlen = 60
# 每3个字符为一序列，类似步幅
step = 3
# 保存序列、该预测的下一个字符标签？？
sentences = []
next_chars = []
# [0,600833)等差为3的索引
for i in range(0, len(text) - maxlen, step):
    # 步幅为3，长度为60的各序列。列表长度200278
    sentences.append(text[i: i+maxlen])
    # 索引60、63...600831的字符。列表长度200278
    next_chars.append(text[i + maxlen])
print('Number of sequences:', len(sentences))

# 文本的各唯一字符。set只保存唯一元素，但不可索引且无序，sorted按插入顺序排序。列表长度57
chars = sorted(list(set(text)))
print('Unique characters:', len(chars))
# 映射了各唯一字符与对应索引的字典
char_indices = dict((char, chars.index(char)) for char in chars)
print('Vectorization...')
x = np.zeros((len(sentences), maxlen, len(chars)), dtype=np.bool_)
y = np.zeros((len(sentences), len(chars)), dtype=np.bool_)
# 对200278个句子（序列），对长60的各序列的各字符
for i, sentence in enumerate(sentences):
    for t, char in enumerate(sentence):
        # 200278个，行60列57的独热向量
        x[i, t, char_indices[char]] = 1
    # 200278个，预测字符的标签
    y[i, char_indices[next_chars[i]]] = 1
```

    Number of sequences: 200278
    Unique characters: 57
    Vectorization...



```python
from keras import layers
model = keras.models.Sequential()
model.add(layers.LSTM(128, input_shape=(maxlen, len(chars))))
model.add(layers.Dense(len(chars), activation='softmax'))
model.summary()
```

    Model: "sequential"
    _________________________________________________________________
     Layer (type)                Output Shape              Param #   
    =================================================================
     lstm (LSTM)                 (None, 128)               95232     
                                                                     
     dense (Dense)               (None, 57)                7353      
                                                                     
    =================================================================
    Total params: 102,585
    Trainable params: 102,585
    Non-trainable params: 0
    _________________________________________________________________



```python
from tensorflow.keras.optimizers import RMSprop
model.compile(optimizer=RMSprop(learning_rate=0.01), loss='categorical_crossentropy')
```


```python
def sample(preds, temperature=1.0):
    """
    采样函数：对模型的原始概率分布重新加权，再对下一个字符随机采样
    """
    # 格式化为float类型的多维数组
    preds = np.asarray(preds).astype('float64')
    # 常规利用温度对原始分布重新加权
    preds = np.log(preds) / temperature
    exp_preds = np.exp(preds)
    preds = exp_preds / np.sum(exp_preds)
    # 对新概率分布抽一个，返回序列抽中的单值
    probas = np.random.multinomial(1, preds, 1)
    return np.argmax(probas)
```


```python
import random
import sys
```


```python
# 训练59轮
for epoch in range(1, 60):
    print('epoch', epoch)
    # 200278个60*57独热向量，200278个57列标签
    model.fit(x, y, batch_size=128, epochs=1)
    
    # 0-600831的一个随机数，之后的60位为随机种子
    start_index = random.randint(0, len(text) - maxlen - 1)
    generated_text = text[start_index: start_index + maxlen]
    print('-- Generating with seed: "' + generated_text + '"')
    
    for temperature in [0.2, 0.5, 1.0, 1.2]:
        # 该温度下的种子文本
        print('----- temperatue:', temperature)
        sys.stdout.write(generated_text)
        # 之后生成400字符
        for i in range(400):
            # 一个，60行（生成字符长度），57列（唯一字符索引
            sampled = np.zeros((1, maxlen, len(chars)))
            # 对60个生成的种子文本编码成独热向量
            for t, char in enumerate(generated_text):
                sampled[0, t, char_indices[char]] = 1.
            # 根绝文本的统计结构、字符的局部模式，预测的单组索引值概率
            preds = model.predict(sampled, verbose=0)[0]
            # 温度权重采样的布尔索引、所采样的字符
            next_index = sample(preds, temperature)
            next_char = chars[next_index]
            
            # 将预测的单词添加随机60之后，去掉第一个词
            generated_text += next_char
            generated_text = generated_text[1:]
            
            sys.stdout.write(next_char)
```

    epoch 1


    2022-06-04 15:51:31.481000: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz


    1565/1565 [==============================] - 103s 65ms/step - loss: 1.9705
    -- Generating with seed: " pedant
    and bonhomme. did he perhaps deserve to be laughed a"
    ----- temperatue: 0.2
     pedant
    and bonhomme. did he perhaps deserve to be laughed and the self-considered of the farth the conscience of the self-concernation of the self-contend and be some of the for the self-soul the present and all the sen self-contimate of the self-dear and all the ser the self-all the self-all the concerning of the precestity of the self-all the conscience of the self-all the self-conscience of the self-to the stronged and all the perhaps to the self-conce----- temperatue: 0.5
    e self-to the stronged and all the perhaps to the self-concernation of the contimed to son to reas and all be all vigit of himself of the far a dears of who has a stands of the sere, as a concernant conscience of the sere be means so the stringt readoud of the find is the dest something man a d and truth of the fate of soul dut at a so latifatic in the interses and the should and what it is a constance of the flee the self-soul for should speak be not when----- temperatue: 1.0
    tance of the flee the self-soul for should speak be not when-eet no-inly god for so dolecationfledts and treatly we rispin foring all
    extremsised to lut
    is ments the
    perhags
    its all propsiul vigitive
    of geerd of call is.
    --axnist whele have theists no  the emis their no have passoms at acce, theoues of whon to only of oul thes that pilituar of is not fearm, is ghericaliest rechation.
    
    i 
    whousque, whie  the or. his es truen  do bele, and (reedoly an may an----- temperatue: 1.2
     whie  the or. his es truen  do bele, and (reedoly an may any gnurable--hugondso upind; alto thios frees to pro-to
    macks i  igxelayw or for holemdatty. o" it is wo cloumed, lom, one which in modanness--everything stat.hathessugde must say, whot
    will should (so just a morals eachonly wnece
    thrims, germanionous even
    ant 
    =heroroeimpable gane from fullikionapays, whith appoofth to wis own confacize, ornjuable wehe sepist it as his.,
    : befurely.
    "who to
    tomes
    epoch 2
    1565/1565 [==============================] - 115s 74ms/step - loss: 1.6164
    -- Generating with seed: " in respect to him who must obey: "i am free, 'he'
    must obey"
    ----- temperatue: 0.2
     in respect to him who must obey: "i am free, 'he'
    must obeying to the generally and something and the sense of the moral to the self-dectine of the most such the god the generally that the man and the sense of the senses to the sense of the man to the sense of the sense of the read and the spirit of the sense of the god to the sense of the sense of the sense of the state of the sense of the sense to the readon to the moral the man and have a generally the----- temperatue: 0.5
     to the readon to the moral the man and have a generally the seam of which the
    soul and in the pation and to the metary, the such the has to the bear, to simple conscience of the perceeve consciously, and man of the most former an one of the readong the moral and contrue in varwered that the man, who has only to decianting and history of all type and how to the
    seaks to consequent in the regoidsel. the most part
    itself who has been and generally and the me----- temperatue: 1.0
    . the most part
    itself who has been and generally and the mealfurs of the the keathess not provices of
    take of it. a quirit!. one abely: because he as for pensuitance, plingable regard tome, patic opinion, we beluect tne many
    europially andionour of the fastized the
    self-goder: the gener in plans agon their phract adols that he is perhaps but and canfor and presence vaner conscience the intensely exceciade, throughe
    to the
    semich that a though the gol in p----- temperatue: 1.2
    exceciade, throughe
    to the
    semich that a though the gol in perhaps set wert
    magnefus
    -
    
    posil
    solselves as may that "to
    deedfu-nesphened, his philosophess of it. lomed as alredo
    tims ghilsipatiwhess,
    he would bat,
    evilrttaned" 
    at
    that he can
    whow once, valused neasonizing is must . what djay, throuth to now others
    it--and of the itsally, be but differed
    will refenmsy bad vigi9ury, lobt van"ers burl! thralying culture! only veibith verious exalming ri, as epoch 3
    1565/1565 [==============================] - 132s 84ms/step - loss: 1.5270
    -- Generating with seed: "of logical violation and unnaturalness; but the
    extravagant "
    ----- temperatue: 0.2
    of logical violation and unnaturalness; but the
    extravagant and conscience that the sense to the conscience to a conscience and and sermosity of the servest and the religion of the more the same and and and the condition of the sense of the conduct to the ancient of the present the and the more the power of the sense that the sense and the sense of the power and the belief the one of the more and servest that the belief to the sense of the present to the s----- temperatue: 0.5
    servest that the belief to the sense of the present to the sign and condition and into the order to the belief in the restray and the and consequence of the mast more to the words and look and make are with the hase it is a more goder and the stronger to the antition, the case the words, other words, so that the still being distance and power to the words, in the existence it is a
    condition to another to accordance, and the more have been would be a refule----- temperatue: 1.0
    ther to accordance, and the more have been would be a refulenes in wishal,
    day
    to ha-greatible grotiving inflice
    stacselt: a rnell perceank littlic only to most case is ventional, with an
    eist living may exieterbe repire
    ha isually: what has and bavericed? has that stetds that this spegiots of a sympaalimanition" good,
    slpetion of its falsalities;
    and be fode
    the joy a wort higher who has comight that a even one that the utered word, the begon treat becour----- temperatue: 1.2
    that a even one that the utered word, the begon treat becours woner nadiaus--my point masm
    one atequence, a
    makened. that i hasiasne, obitety! that the thist tencince:
     und symfthes; no
    philocopher absel: predient his mutiafuli, the
    fine voluntary of ta, and get and imchilo cips,
    beciushed egi a
    unwemhtual philosophaonre an irmist most would deatifuablly, even to infeism
    voniting. things, at an the plass b; there, one s, and morely
    adpquetion to reportishiepoch 4
    1565/1565 [==============================] - 152s 97ms/step - loss: 1.4803
    -- Generating with seed: "dern ideology and gregarious desirability, as their
    antipode"
    ----- temperatue: 0.2
    dern ideology and gregarious desirability, as their
    antipodes of the start the start and the distrusence of the despect to the sense of the strength and the stack and the strange to the and some of the strong and the state to the start and the same the start and the despect of the strong of the start and the start and the present of the strong and all the start and the contament of the stall and and the consequences of the consequences of the strange of th----- temperatue: 0.5
    nd the consequences of the consequences of the strange of the consider to the present of the refendetion when it is the free strength of the same and acts of cause to the most difference of our disconeration to a longer, he are soul and had we divening the stape so the conturance of the started to be all who are some ratistowical presented and in the experience of the out of the states of his engling the distrust of an atterused in the diderable in the sta----- temperatue: 1.0
    ing the distrust of an atterused in the diderable in the stall now--to celian and
    thouse regarding and id its truth antority, whereo in the urtention, is at conorier,
    point consegated perhaps peowed with a detrange, to the trustoricalt and for the congesting instinntally very accompary that is upon the
    exechanisms of many the maved
    hercoris, a methowismable ism-somele to be comnic morey heass
    of when order decondudence as it is pryforn of dettical friramso----- temperatue: 1.2
    hen order decondudence as it is pryforn of dettical friramsoly is atten, from frighteng
    only
    be cia
    very plecious ary the eassed tradible; it is evirr agains,  the
    meture
    maid evenly
    haven--nom ne
    exart:a be takes the greatest for, with gestament when the distorca, theirit.ly
    that which opprusms --as learnion: 1we her it gomed, like the taken, when the
    e the day and
    i who hous it some, a cest
    be dufies of enjoym) are very seid-no trarty upmans suny, recognepoch 5
    1565/1565 [==============================] - 154s 98ms/step - loss: 1.4503
    -- Generating with seed: "story, and in general only under the pressure of christian s"
    ----- temperatue: 0.2
    story, and in general only under the pressure of christian something the superselles of the sense of the sentiment of the strength of the superselles of the sentiment to the supersion of the sentiment of the sentiment of the course of the states of the sense of the sense of the same and the sentiment of the sentiment of the sentiment of the strength the same the sense of the sentiment of the sense of more and self-prearhy and something the states of the so----- temperatue: 0.5
     of more and self-prearhy and something the states of the soul to the instrument in the reason and every the consequently there is one seeds of the prea of mankind and all philosophers of the man at the supersion of the same more, and make as it we comes the disconeration of the diper with the superato believe with same always and middly may be would present sense of the same compared of the really with self-beaut of the still in the creative of philosophe----- temperatue: 1.0
    y with self-beaut of the still in the creative of philosophers" in there so of legim the aqaking that the involunce: long
    fear more differing the sample timism of chirst, which used standt but
    maral, the going the on and really endremomen rese bey first, thinks imposed in rexolder of all becadeal way
    binds remort, our early indeed preatifing his hands
    view of nature not a congeratiousns togeth, as and advird philosophical said, and matter,
    which the dening----- temperatue: 1.2
     and advird philosophical said, and matter,
    which the dening and
    immored instincts.
    a squrently strights, ow formerly did that theichment diffears
    of dispysioned that deal they beor eyficom--onles the oughtarturing-htolling in, beceat judgences, with
    ideautivences should shem xbedualy bagter-scherisby itself of all eonguary the promises.
    
    
    12) 
    ut thuss simp who ofter would
    orn sympthing nimbulates
    music
    still somegined"; repriveby the great brutates frencepoch 6
    1565/1565 [==============================] - 150s 96ms/step - loss: 1.4288
    -- Generating with seed: " but
    rather the five hundred hands which it requires in orde"
    ----- temperatue: 0.2
     but
    rather the five hundred hands which it requires in order to the still strange, the more the more the experience of the comparis of the stand and the sense of the state of the still our experience of the constitute of the comparis of the same the constitute of the more the german something the complain the believe the more the state of the standard of the compendence of the more of the spirit the complanter the profound the interporation of the stands ----- temperatue: 0.5
    the complanter the profound the interporation of the stands of the subject which he seems the promise have deception and the thought the more object of the constitute of a command the world and in the german proventer of the fact of the more who self the view of its which all the fact they have a men is at the though the trantither process, as a parting of the reason the love the profound of life its taste, and has to shame to the begree that it is not mor----- temperatue: 1.0
    its taste, and has to shame to the begree that it is not more, there patsienant reveloped--they
    so ; . which even you tlette a his racy
    alr over. oblice exhoracisar iscornes of intertalled number and the will science, all the chirst estimate cause--and and ye thought more thorustience there are been danger (which is stitude of men that as last even manive. as reduch, and the thef
    greek, it revefined
    that that, to owertiling that essentially
    speek that the ----- temperatue: 1.2
    ed
    that that, to owertiling that essentially
    speek that the compatring
    pokness and force, ress
    the
    chrustsymate larch
    into lack profeciomicated most so, that what len much who has good--nemble
    our, a is tendly how man ! b) it_ heary: and remain have been
    for. 
    good-skithly is esiciny forthhtudicms," should noto"chentry imputed-- --relation of the
    means of ut: a
    wagknes to the baduredh, dartiess, acpriitr symptiqher
    spirit succelt" he caul and ouw well thatepoch 7
    1565/1565 [==============================] - 163s 104ms/step - loss: 1.4117
    -- Generating with seed: "s had and are still having the advantage; the more
    select, m"
    ----- temperatue: 0.2
    s had and are still having the advantage; the more
    select, man in the presentially the present self-contemption of the present consequence of the sense of the sense of the present could the proposition of the present care of the problem of the sense of the destray to the present the sense of the sense of the proposition of the same present constant for the problem of the sense of the sense of the such a states that it is a states of the present such an and----- temperatue: 0.5
    such a states that it is a states of the present such an and same more thing they be actually by the problem of the rest in the high to seem perhaps have and as life for indeed by the extent that the fear of get and most discovered and expecity and in the dangerous are perhaps hidden the germans for in the self-contradict to the contrary as the intermors of the truth of his artistic in the profession to the philosophy in set the christianity and profound b----- temperatue: 1.0
    ion to the philosophy in set the christianity and profound be great religious probably attraded from germanss
    died.
    
    
    1a a something as let us to the uneepfrops, of art--as to things to who mut and now, his stattims instincts nonkerfirs that has been
    once obednence is one poinoes's clemility of a delicate far agoishly be newlewoht the worlds even that aawa; the
    preseplivited his rest with the peasond; of they may be recond, i are one;  it is exception is a----- temperatue: 1.2
    ond; of they may be recond, i are one;  it is exception is a phream of indianifle must formul od o"
    has howethy: to lofts hiders, qualing gri, with the hird and thar emot,ul srawe, i nenesamet but wnest geant"d? one iseal-cout
    agree, in opait   a consciences, as notew: we will speetple the curce-fashice) and ass
    by noish in excendative marement aroins well of bad and, new guilt opprehopaniol, theredo and ptious up. (hus forges, to overseovom. to him alsog epoch 8
    1565/1565 [==============================] - 150s 96ms/step - loss: 1.3983
    -- Generating with seed: "bitter,
    and too modern, it is as arbitrary as it is pompousl"
    ----- temperatue: 0.2
    bitter,
    and too modern, it is as arbitrary as it is pompously and constitute of the sense of the states of the restruct of the same and self and such a sublifical and some of the astract of the same intellect to the same will the same and some things and strong and soul, one of the same such a such to the same the conclusion of the same and really the same and contition of the same saint and some of the religion of the sense of the same and strength of the----- temperatue: 0.5
    of the religion of the sense of the same and strength of the constance of the same and means, as a perhaps to the contition of the ressection and also a protectual and may be other interpretation of the religion and liw long onesely now-dor can all the contempt it of all the responsible of the experience, in the fact with the souls and also an all their own the fact or every mankind of the struch on the strasten and extrang to deme and desires of the same ----- temperatue: 1.0
    on the strasten and extrang to deme and desires of the same ason the dirlo the remart religiok, in our nobled, distrust our forthgning
    around and carmed. is conditionisance apparable thing in the sublificated ralial that, they battenation, and fater
    offin!
    for intellect and miscry an
    inacustakings, the subtlesm of the simply philosicismplately preacless
    of
    cheniess
    and extrace not most regard all lost thing to its
    unwelod of pmetar gregted toou, pref ale o----- temperatue: 1.2
    lost thing to its
    unwelod of pmetar gregted toou, pref ale onge woaldtw
    for
    an it, falsible; then: it is a man apperingings, sacval sury to yes that we state intalnast notions whicn would hides" concealestou(yous, or
    "fathers had aothstonal
    teathien much earled forms, asbutiots likew: but will
    exagrant whice the
    dispoakt treatives that exerfele, or book,
    knive hardmwil a mighting, only at the soul of thingsd
    in reny sesscristable and seup mees ofsest, is aepoch 9
    1565/1565 [==============================] - 135s 86ms/step - loss: 1.3862
    -- Generating with seed: ",
    as has been hinted, that a scientific head is placed on an"
    ----- temperatue: 0.2
    ,
    as has been hinted, that a scientific head is placed on an actions and the souls of the sense of the sense of the sense of the soul of the souls and a promise be restrict and the stronger the soul of the spirit, and the most distimans the man and some distimate the sense of the soul of the sense of the spirit of the souls of the age and souls of the sense of the sense of the spirit the serves of the souls of the spirit and souls of the most soul of the s----- temperatue: 0.5
     the souls of the spirit and souls of the most soul of the spirit to be into men of the expressed of his soul, to be man and benewar who diving of the sense of the
    sense and the discovereration of the truth as the intermoming and in man in the helogers and prompes and blos of man and grows of life. the proys and we all in the begrough the most say, in the "fair, and with some in the
    spirit of the most souls and religion, and in which they has been its acti----- temperatue: 1.0
    most souls and religion, and in which they has been its actions! why states a barked, the germanile,
    under the nature, but
    a called with, a mirblecomed to give a garbific of we powerful and science. the privees thinks to typed to at rening, by the herx to later seducsuation began, he an origit and seco excession, which the other life conscience of will be is religiogs the milds,
    with promise and the away an a kind of great mirkg1ly
    the rupe it was reading ----- temperatue: 1.2
    he away an a kind of great mirkg1ly
    the rupe it was reading believe, former? it has for ansitions of fest if betried and schope.
    the wayitias harder niturant
    tratinge. be admattimes: must object dogmginion. from germaninxsious in the is comman
    will sendrve once necessity, vreases--a b. mady recognism, that understand alyoact seidhp in fact time, may be manigsporrific,
    synverves by what he its "indy, but he is not higher happiness away withlenged
    not
    opposiepoch 10
    1565/1565 [==============================] - 137s 88ms/step - loss: 1.3758
    -- Generating with seed: "orm," for which the expression, l'art pour l'art, along
    with"
    ----- temperatue: 0.2
    orm," for which the expression, l'art pour l'art, along
    with the sense in the most surperation, the spirit, the superficially the precisely the world and complened the believe the strong and desire that is a still the morality, and in the course, and the world and also the world and self-denended the spirit the sense of the present the same and consequently the more and precisely the morality of the more and the far and always the strong and artists and th----- temperatue: 0.5
    he more and the far and always the strong and artists and the world and the here are as a still and receive vict the responsible and as any even he is the straught all this asside of spitive in the consequent and the self-such the most very are and even that the desire that the profound of the more fate, with the has not one's actions them consequent taste, the are and impossible, the right and allow that which is not for the sapiration and closes and weak----- temperatue: 1.0
    low that which is not for the sapiration and closes and weak, the lower the highest are
    stranging his puriting mus, stool there are this errmay
    inclaws and ye of should reemed): and in allosses
    to  "fully: the infarious but because as a tewan
    assection: pelop justs of the baulmation: what even preciatovid calvationas within cantasicaus as steplater
    that a bouti is hust, where hence infus. the man graticisyical with-caluuation. but the bothing that if
    farii----- temperatue: 1.2
    graticisyical with-caluuation. but the bothing that if
    fariis writh, of "relaging,, mootter? is desire that which all, the clausuer does no othertoal he is does hhamot of unffiguracbation,--theirely: mankind. some great; he relationas a passionates. sout that those "igne: "inside toou, even to error, yfirin from the oppreatifmuse. which he
    godrdarrycnabuted portrol imbort of ""efrect the east, never hyt--"thist of the has to ethich virnar. evil, a conditatepoch 11
    1565/1565 [==============================] - 133s 85ms/step - loss: 1.3678
    -- Generating with seed: "t be almost inhuman in order to follow the
    opposite course?
    "
    ----- temperatue: 0.2
    t be almost inhuman in order to follow the
    opposite course?
    
    
    
    12
    
    =the developed the states to the standing the spirit with the spirit the spirit the standing the state of the community and stand the stands the state of the same thing the same thing the states the supposition of the sense of the standing the same the states of the spirit the supposition to the constant responsible the state of the constructed the spirit the sense of the same thing the spi----- temperatue: 0.5
    e constructed the spirit the sense of the same thing the spirit state and transfor that the taste, and antither permize the transcend of a great present that he his is something believes himself are far that capacity, which he is the degree of the community, and woman upon the responsible in the sulting the stands the present to love of the highest sense of the defined the world and souls that which the real owing to the same states that the moral in the r----- temperatue: 1.0
    ch the real owing to the same states that the moral in the respect, the voluntary moreover.
    , how regular the enempy of many constant communiliguted, concessing in it beca or the
    taste"
    and an ibited bysving her conforms since for fundamental expression: rome something
    envarigeljby and reflect with the sacrifi de not psychologications. but i may not destruction,--man
    philosophy stolant with truth,
    benepsecous up! "even it is emotions to gevins are fents al----- temperatue: 1.2
    
    benepsecous up! "even it is emotions to gevins are fents alreavation is-collises
    can faithurines in the disdring immente;
    everned almost
    hun, in acts, but cappress
    of law, may by the hear, and there's
    and
    moraliwf even far such and
    religion: now can
    beings to chang of his helpled one can
    how mankind.
    prepatel tylect. it set the virtue; ever of any any self-des mans feltfulity snikile the essecriw. a
    mide to which otherly
    bermaco: i was historical ezrnandeepoch 12
    1565/1565 [==============================] - 138s 88ms/step - loss: 1.3581
    -- Generating with seed: "wilderness, something of the murmuring tones and timid vigil"
    ----- temperatue: 0.2
    wilderness, something of the murmuring tones and timid vigilest and the free spirit and consequently and for an extent of the same and considered and souls and strict of the present the same the same the word of the fact the same the expedient and constitutes and an an an accouncen and strict of the same the heart and an an excessing the free spirit and strict of the same the an accounter of the actions and spirit and the actions of the expedient and belie----- temperatue: 0.5
    ctions and spirit and the actions of the expedient and belief and the higher at the present and because the whole of the world of all the delight and discertain and a the hears for incalled and to desire of the intertal and and far and right and character who has it will the the consequently in the persualy precisely he should be alter of his way and become the demands of the free spirit because be deprecially one's fact and degree of
    such assich to can be----- temperatue: 1.0
    e deprecially one's fact and degree of
    such assich to can become which its who despents the distrash arm, he healt. if an it
    great perhaps and ththe higher ewo bull. to contraratening, every men is not attentquance,
    has ?
    
                "enorigness, perposible revenges. if is becoming an antithing evolugoteny he far the rual believe
    who strice
    and the three
    has
    species: the friends?
    
    
    oner entlake upon are inepresses of incardent such these
    enthysic
    markey u----- temperatue: 1.2
    pon are inepresses of incardent such these
    enthysic
    markey upen manives while of fellogy of this
    pass of reity
    andilests.the lives the ind --alm. for pacsome should strengtihiey, are incustable and reasily? and detristich, and then basic
    matter of regarding themsepling
    even the gentl
    ogigin, littless
    and clrpising famtion.
    oqpicionical dystarid than one's flun
    the
    alreedy
    and
    obficuous -lar
    of has righyourer. if theor
    inable conducis of saughes, can, couraepoch 13
    1565/1565 [==============================] - 138s 88ms/step - loss: 1.3516
    -- Generating with seed: " must he say despairingly to himself: "a single individual!
    "
    ----- temperatue: 0.2
     must he say despairingly to himself: "a single individual!
    
    
    111
    
    =the states of the belief and strong the spirit and the sense of the sense of the sensed to be such enclassion of the sense of the charm as the promise and the sense of the spirit and conscience of the consequent of the conscience in the protectoring the spirit and such a moral faith that is at the sense and conscience of the first of the such a such a moral the barment to men in the spirit----- temperatue: 0.5
     of the such a such a moral the barment to men in the spirit to a second, the truth every bad the sensed the substience of the truth of the latter formed true be
    religious consequently seems the spirit of the concerns of the characters, and in many be spirit and because let us be man is a god bo. so much as in the sensed to be the death of such certain persons, and its first of his tasce bad into the world be reason the more of the sense and severity of in----- temperatue: 1.0
    the world be reason the more of the sense and severity of inhersperion (which to be ablootanes, that is and sourty form of might
    caves
    and
    just a more,
    capac, in mights in pleasing,
    acquire they bellw-nher ordethings of probably.
    
    12e4 how threate," which,
    lecom affordents and miserdly great a other comeating the
    depthing, for because that religo joral, right to far, na
    the motter justifications-spire an evor of prigh and philosophys with a logicisngersly ----- temperatue: 1.2
    pire an evor of prigh and philosophys with a logicisngersly becausabulousn-lover. he dildoving a ;ate, to learn not do desirate
    and
    viewed-- wain able: they waryonvloves, elty
    loar rule when (in feelings!of and prejudice prompirations.
    .
    
    . the species of illowunary common..--of dame
    stitudite domain; comcallek: liyes these resolves, slogate of fathertation
    in oppiration.
    
    1e
    
    rational kind the whery orglionces ofisped eyopation
    to them evilsly
    innamer domepoch 14
    1565/1565 [==============================] - 139s 89ms/step - loss: 1.3445
    -- Generating with seed: " he receives everything that
    comes his way, his habit of inc"
    ----- temperatue: 0.2
     he receives everything that
    comes his way, his habit of incausance of the same and spirit in the concerning the sense of the sense of the same the sense of the same care and spirit and suffer the same same things of the same will the sense of the same things of the same history of the same the same concerning the same things of the same and such a more really and sense of the sense of the same the same things of the same the experience of the same the con----- temperatue: 0.5
    e same things of the same the experience of the same the contempt the concerning species of the contempt the seem to them in values, the contradict of the same things in a person of the sacrifice of the moral desists one spirious concerning the entiremself--and to a more conceived in every copernation. the experience in order to person sufficient decadines of delight in the same will the trought and self-desistation of the single his and self-contemporar a----- temperatue: 1.0
    nd self-desistation of the single his and self-contemporar and
    monkves once
    astronk of
    statious modern good": "soon  a sensitives is sugors terks of itself rrong
    inspire to the contririties man all ssys that verut he god by his actions regard and truth in science of someth"
    even he seemon:
    
    again rigepled
    nexe promited anyon, refined one among one has seems the rule that
    is in
    food" were in life of a "herr everatt heart. there is understand theologoce walt----- temperatue: 1.2
    f a "herr everatt heart. there is understand theologoce walt; he mode in o-down isnew were once
    us.
    . i hands, ard.ly
    he infoupogering species of mystheundby knowlved only and lqziaghtaphs semue fell borndquise; of the great stern opposedly alverseln-conlong
    consists in theredness of dangers throughiy have to developed in rerud" to hymor without viewaps even a counterament.
    
    
         irtest man, acconnter --and
    relaps? over the radoxs parnable themselves.
    
    
    repoch 15
    1565/1565 [==============================] - 133s 85ms/step - loss: 1.3410
    -- Generating with seed: "inally, let
    it not be forgotten that the english, with their"
    ----- temperatue: 0.2
    inally, let
    it not be forgotten that the english, with their spirit as a man and completed the same things for the precisely the most present say, the sense of the present the delicately be not the present stronger the conscience of the present conditions of the conscience of the same things in the present concerning the sense and the instincts and the heart the man that the existence of the conscience of the present spirit of the same things and conscienc----- temperatue: 0.5
    ience of the present spirit of the same things and conscience and sense that is ans
    the predicater man is strong and fundamentally become the sense and
    the best religious with states, who will perhaps according to be an the conceived and some delight for the morals of the conscience the same wholly see the country and lift and personal man for a tender that it is an
    european of his concerning the man consistence, and the whole deed into himself
    so the spir----- temperatue: 1.0
    man consistence, and the whole deed into himself
    so the spirit. this is taken, that righture accepted up--a doubiting upon a subuleness, that even olders, be
    not onrarneds in a consequently preceat
    our originater of gult who is finge how to philosophers.=--ideanstic fully sound!"--there are scare the generate, deserces truth and
    hawseing necessity), that it is present still this mates of germaning been of will just ourselves is mates, as been id its opport----- temperatue: 1.2
     been of will just ourselves is mates, as been id its opporteteled
    onestring not to afterstof the
    dency garn, as hoon, it has have
    himself, for of he, i philosofy-lisged us, so
    very jes with this
    testied where the "thum, whith the oos the languameuns in chent injuring different attance are for inhnejtionion
    which is unmenseation: they abosebor
    sylitay
    bepatesed, know is prekshow has
    alongimaiss io reasoned injuriation.
    therely
    and existence after, and
    fearepoch 16
    1565/1565 [==============================] - 160s 102ms/step - loss: 1.3337
    -- Generating with seed: "y insignificant problem--left in dust and decay--of a
    descri"
    ----- temperatue: 0.2
    y insignificant problem--left in dust and decay--of a
    described be many command the most superiority of the states of the most subtle and some destruction. they are any presenter and strength of the spirit in the states of the most presenter and all the self-and and something with the spirit of the sentiment of the sense of the word of the states of the same and something and the spirit of the states of the states to the states of the spirit in the present----- temperatue: 0.5
    tes of the states to the states of the spirit in the presenter the act of the anemy
    of the word of the fact that as one must distrustful and something pained become the conscience, the responsibility is the spirit not the spirit with an extradisation of the case of the most states of the stall will this and every
    explains, and men with the contrary as a preserved the profoundly more same and most predicatively seriousness of suffering, the and lose and so ----- temperatue: 1.0
    predicatively seriousness of suffering, the and lose and so miust law toplen my ridily empopided that out last sourmites or khings-act of
    the slave--their metaphysical impendent game of
    god. with his
    wage spirituality to mest me.--interratilemation. the first the case--the
    psofromer alpsist woaker they the rewilts
    into the
    and
    mredicy and religion for a means, which kind of the profesed and image nowadays and beenal
    only stome abitual that are grou from hi----- temperatue: 1.2
    nowadays and beenal
    only stome abitual that are grou from hild dinatimay extra!very.
    he
    most refine.ingeant still
    dayurers. the
    old beenful, unperiod will -one's scarnence. as they usefuriture have many men of
    madty yes-intosituacly
    part. a parehe for man"cant him. hea.
    upo
    when whan it must viewess may posseold fooper. as a times people i as from the depth creature
    and success fool, unfortlent effectable, wide-compare that have a"ganith last
    statening,
    
    iepoch 17
    1565/1565 [==============================] - 161s 103ms/step - loss: 1.3290
    -- Generating with seed: "rom that of
    the present, non-moral. "unethical" indicates, t"
    ----- temperatue: 0.2
    rom that of
    the present, non-moral. "unethical" indicates, the sense of the personal the same the sense of the strict and sense of the contempt that it is and souls the spirit in the fact the same in the contempt of the string-even in the strength and such an and species of the sense of the personal the responsible, the consequently and the self-ears the sense of the same and such a sort of the sense of the same and souls and the sense of the conscience of----- temperatue: 0.5
    nse of the same and souls and the sense of the conscience of the ancient deceive the lanality of man in this souls the deal and a skin in the consequences and common to demands the "the most man for the future of the sense of the entirely strange, and consequently a reason man for the relations and mankind, and who should self-contrienther of the conduction, and in the causasic them of an over in their pertours of despised the hypothing upon the same has a----- temperatue: 1.0
    their pertours of despised the hypothing upon the same has ane a object! much
    detering and many wholly go deceive and impro from a faunt
    denation of ues
    often added to who account, and but somele here false
    moralitial, whehelot--a nxient
    kingsparioushtually perhaps visus in faith its unbefromes childbooc is no feer naivet of
    betweresal even inowurs to the sitatar reals,
    into still that a short, and induparting fine sunstitity "effect, of men can both and a----- temperatue: 1.2
    d induparting fine sunstitity "effect, of men can both and appearonish and
    peendsifiest
    attual ourith"s and envuraos of lies names "best to becoments conducts evil, of knowlyt
    yeur helps between vivisnoligiand in killeds having of beal part who seterspearmentsion openil; its do mankegs and devil-morals,
    incringny, that a relebments? as xcist happing for slaver baves to dispose-retringhed"--as the hedrarary often with general mind had even in dogmassiss: a epoch 18
    1565/1565 [==============================] - 164s 105ms/step - loss: 1.3272
    -- Generating with seed: ".--much, too, that is frightful and
    inhuman in history, and "
    ----- temperatue: 0.2
    .--much, too, that is frightful and
    inhuman in history, and the sense of the sense of the spirit and superiority of the sense of this very fasting the same things of the spirit in the sense of the same things and superiority of this sense of this things when the sense of the sense of the spirit and superiority of the sense of the same things of the same will as a man is the world and the spirit in the sense of the same things which is the sense of the sens----- temperatue: 0.5
     the sense of the same things which is the sense of the sense of the sense of self-completed
    deplaces by the most interpretation of the senses of sympathy the restolows our contemplate delight of every really to the superiority and every counter contradfice in all complications of him taken that the prother will is leads the senses in which the sense of this destingual served all the manifests of the significe he does not be was a question with the
    contemp----- temperatue: 1.0
    the significe he does not be was a question with the
    contempodianing worth ups which those men, if this religious inding,. the funcelt, moral manifold any
    get the whole with long it convinces difficult redlication. it wo be-dute, and comprehousess, unclinasters
    by which it gets out as every music hithertociviable a
    only organicis pro--when man capable of christianary
    who is a life? even who countomuald upon falsed far errowing of plessures of delightful se----- temperatue: 1.2
    muald upon falsed far errowing of plessures of delightful sevel nature or , hrovefor how after men tomaginesd.
    
    38 gorcher, b-respondedgupteing, and "involuntariginely,
    when
    weirs with germans few moralthy acts of mistaken. does they to compruhtinus "will.too furtule, he cadely, 
    convenial emitiens its patisisk. when one
    atthisoment rattering of opposite,
    old gretrans triture assome;
    once
    without rea. therely perheple bring to spirit from the genere
    from aepoch 19
    1565/1565 [==============================] - 157s 101ms/step - loss: 1.3199
    -- Generating with seed: " the temperate men? the "moral"? the mediocre?--this for the"
    ----- temperatue: 0.2
     the temperate men? the "moral"? the mediocre?--this for the spirit of the same present the problem of the most spirit in the same thing the spirit in the same many deviled to the same thing and superiority, in the most spirit in the same thing in the same present the present the spirit and self-entire in the world conception of the spirit and stronger and supposition of the spirit and superiority--in the most spirit of the spirit, the spirit of the spirit----- temperatue: 0.5
    --in the most spirit of the spirit, the spirit of the spirit of an over that no many felf man which the prooding and and experience of his problem of the condition of the more philosophers of the contine and inclination of the one in the same way it all disinterest and condations in the most many the world the good thing and earit of the latter popular ariture is also man learn that the owing the contitable his present, the essentially law, is any same
    and----- temperatue: 1.0
    contitable his present, the essentially law, is any same
    and suffer
    admist degreed and commination, or give the inlease only inorual, who christianity, hran, and it is can cleal of its laws to much
    experiences in premeated tmisten which would let
    the first and men have dothence, they ranks the make the graditity:--it
    must recoulds in the learn thouse humber-will who thin dehown above ournes, this was among good learn, which canlone he case.
    
    
    18s must beor----- temperatue: 1.2
    was among good learn, which canlone he case.
    
    
    18s must beork--and it
    may reall and lalk, and will instance wide "free, knattful vitient freedoms, are humness, is truch
    to rank, for o-germancy enfurice or anti?s tacking. thusly and discretions,
    of "enoughgance and inthores and laws trating with tome-for solitudes instinct, however, and betite a lartoy, indemostions,
    proper may
    love this eiubabind his fal am, this exportions and clear
    stome--one's skiem in epoch 20
    1565/1565 [==============================] - 131s 84ms/step - loss: 1.3161
    -- Generating with seed: "rvation, self-elevation, and self-deliverance.
    nothing but n"
    ----- temperatue: 0.2
    rvation, self-elevation, and self-deliverance.
    nothing but not a sensitive and string and sensible to be more such a strong to the morality of the sensitive and sensition and superiority and sensitive and such a sensitive and superiority and sensition and sensition is not the sensitive to the sensitive to still such a sublime the sensitive and the same something which is not the sensitive and sensition and sentiment of the same such a sublime and the sensi----- temperatue: 0.5
    ition and sentiment of the same such a sublime and the sensitive and most power. the express of such a long acts of the experience in the conscience and an actions of the mind and account of europe. the presentiment, an exception of the consequent and restruction restrictive who care and seductive spling to which is not he would not all such a new the most suncious a callures and criliging enough to distinguish, when it seek there are something has been on----- temperatue: 1.0
    to distinguish, when it seek there are something has been only commend, on, no resucuering renisment.
    
                                                                porablak and detate has one is conversary or tivery old remard. more world swelfaning roke distinction, the fine), when let in such the class virw togation) is the unwoman, for
    what he refugent, who seduce, which part
    like handment manifish. the revenges, morally continued lived,ous for "fally, i----- temperatue: 1.2
    ish. the revenges, morally continued lived,ous for "fally, in their inaus, ood a suvermetific say without appreduct atsae? how in surrived with grot such as
    some limity, it is
       a perceises sinile alone distingues.ly
    ousty."
    erein
    feet with their
    hipsedfyiftiat,
    native, e

    /var/folders/k9/jz3ylm352870dy3rfs1_751r0000gn/T/ipykernel_6917/3316905757.py:8: RuntimeWarning: divide by zero encountered in log
      preds = np.log(preds) / temperature


    ven they ares not adventy and stuche,ouply
    badly
    bsurethre from very heart, like all lake-levily.--inasmucrisssians,--les, aaw, that will peroager lays was above authoww,ilitod,
    whatever epoch 21
    1565/1565 [==============================] - 131s 84ms/step - loss: 1.3127
    -- Generating with seed: "t hearts, he would not easily find therein
    the intention to "
    ----- temperatue: 0.2
    t hearts, he would not easily find therein
    the intention to the sense of the present belong to the great constraint the most subject of the consideration of the most conscience of the world and belong that in the states of the reason and the states of the most done the seriously and be a standard of the constraint to the sense of the states of the sense of the constraint the more of the self-contreding the more in the most subject to the most states of the----- temperatue: 0.5
    eding the more in the most subject to the most states of the conduct, and in the more shows that it is not to the world is assumed it was master, and the belong, which has been words and develop the det to this sense of the stupidity is needs of subtle his great stoped, the things--who has an an
    evil. what is at one his possible before the species of the present, series, of the moral to the feelings in the regard to the self-dects and become belongs that h----- temperatue: 1.0
    gs in the regard to the self-dects and become belongs that hes cerrathous, as early men seems let its flatterations represe on the german same
    to be false percempiles drings of one.
    
    11reantth, which is youthmances of worth
    stays, began with it, as reyest
    danger hitherto verve.
    
    
    1ren from him for morart of suffererity--a reflected with had avertion an interrocal consideration
    when the belate indiparps painful they artistomication.ithord seems to lray of
    h----- temperatue: 1.2
    parps painful they artistomication.ithord seems to lray of
    hus psychological world remantated by that
    impulse an with
    our love, thought, lies orke" is
    agreeded ordeablibys sthurns with in dain," sihosd: it .!
    
    12
    1one is henre
    in virtues: he would mankind, when capacity only as our but
    have
    there allow eethation whereseld ous to extrabenate multial: 
    en it brusarity reheting in grown,, knowledge when also, it always wives
    spirit which was astrutpended tongepoch 22
    1565/1565 [==============================] - 134s 86ms/step - loss: 1.3093
    -- Generating with seed: ", to sweep away from ourselves altogether a stupid old
    preju"
    ----- temperatue: 0.2
    , to sweep away from ourselves altogether a stupid old
    prejudices and soul of the sense of the sense of the same thinks and superficial something and stand the action of the same time in the same the same thinkers and becomes an are and soul and the same the same the same thinkers and problem of the such a man is the sense of the most successfully and stand and spiritual problem of the same thinkers and science, and also the conduct to the sense of the sam----- temperatue: 0.5
    rs and science, and also the conduct to the sense of the same and light--what is to be as the fact for a perceptions that the healt, the understood to the seem to be in the delusions, the possession in this called because some and light, conception of the most successful and science, as all this overount. so that it is not in the delicate and good one says that is also the artists and cultoon also a brought fast ascendancy the profoundly the do a sure, and----- temperatue: 1.0
     a brought fast ascendancy the profoundly the do a sure, and goes an "family,
    subjuges -whosever at all any certain
    one
    every a grow.
    
    124a to this
    indifferen at an is-lcoode, and reared of our from to 'mannce, in the fact that is not distinguom of
    money, manging calluratical
    soul of the ob;ing, and a reste of the artists and cause is didfuls": it is man
    into fact
    as uus so that is long hand only those would may notwimesexxfmarities of the
    means, example, ----- temperatue: 1.2
    those would may notwimesexxfmarities of the
    means, example, that, its
    gractual free spiritaly.sk-moralists, the cangerous
    abit, an abring in a was
    nor nature. onteprement moodness
    from moralw, it are not. a weartous of
    vanise--an atran abad, tadutions, empoms an is-moral,.. there  the deep, under the qualmer thinst cease estimateif so homoss in the opposication"
    as malhalit.th peach, seems already, ambigrous, aos
    beforeful,
    hell",-hnowas infirative lithle epoch 23
    1565/1565 [==============================] - 121s 77ms/step - loss: 1.3063
    -- Generating with seed: "ic in the future.=--as soon as religion,
    art and ethics are "
    ----- temperatue: 0.2
    ic in the future.=--as soon as religion,
    art and ethics are in the conscience of the most profound of the conceptions of the courage the conceptions of the gradually and an and concealed to the demonstrance of the moral proful of the spirit and the morality of the moral conscience of the actions of the courage and the most profush and the profused and the words of the present the conceptions of the artistic and superiority, the profused and the proper to t----- temperatue: 0.5
    e artistic and superiority, the profused and the proper to the great belief theis processes, and devilest and the world will not have in the moral speak to the action of unimposer. in the grough to conceive spirits are as the words and morality of the truth of a morality of the gain of a proper of the uncontradicious that the spirits, and argument and the more has called by the taking instance of
    the spirit is a
    period and conception of the ofter the most ----- temperatue: 1.0
    the spirit is a
    period and conception of the ofter the most curlious
    obdiness and eviled
    upon any
    spirit, or
    music counting of the delights.=--and
    think of a music, to stowe that
    commendally, that by other, will
    rated others and capacity cless speilthely. one of them the worther folly nifference. thepered and surthequently does neor obecinacran,
    practicy, a deate them us--in eachess': then, notners placed function care concealed in whom the injusement, and----- temperatue: 1.2
    s placed function care concealed in whom the injusement, and-grotven neverthglashing for god. and
    there noo author-fruth in the (sha puy of easly yane i pointous, an oxired the ads he cas perhaps venered of their heartry:, only most it cold expedienes. last imterire ourselves," in lufe," yhe spirars and porhert, ha"sljups.
    
    
    2rem found or grow a-liht and our atthatct opinions, and from infeesrant places ha.
    
    128. men are especial
    "religion venturing withouepoch 24
    1565/1565 [==============================] - 116s 74ms/step - loss: 1.3026
    -- Generating with seed: " word, men of prey, still in possession of unbroken strength"
    ----- temperatue: 0.2
     word, men of prey, still in possession of unbroken strength and profoundly and the world and the proper the sense of the sense of the sentiment of the self-controlity of the sense of the france of the sense of the world and discourse of the self-controlity of the most propeat the common as a sacrifice and self-control the free spirit of the soul of the soul, the proper and superficial and the sense of the the most superficial and the self-controlity and p----- temperatue: 0.5
    se of the the most superficial and the self-controlity and perceptions. the plays and the domain of him, the will to deated to christian fortune and only action and look it more lattoring them of the conscience to be there is men to which in which who from conscious and great out of the profoundly and also a serieutions of the great possible, in selfish and
    supposing of commances for not the germans all this world in the denture of morality of the there is----- temperatue: 1.0
    ns all this world in the denture of morality of the there isocieation,
    as actually upon be more faith hear: the
    relffe and e, will in views of spirit has colless
    plewer of its counterpoled thereby higher propeal
    aspect of the bo"sturms with an emotion reveal dupinion by flover-intellide, when more eyes that has me thriphimiem of
    a felty
    is supposing, neford, this philosophy of entlaties of this pplicious
    of the "nothing most apprehimmer, and from surp ance----- temperatue: 1.2
    licious
    of the "nothing most apprehimmer, and from surp ance of most coming with surfurent that
    in at?brduvalary, on the
    foblable in difficult in this tover book, so hagm
    and human possibl, let us congenitience oblint
    itself," europe has concess it, it mowikes oln of super it
    might presentden but woman: theye opproped growin, then the purapourt--time, possibility to graunt of ann secuuld mezsbuture. the pastory of the time, "thry hiut rea; specked by ile cepoch 25
    1565/1565 [==============================] - 107s 69ms/step - loss: 1.2987
    -- Generating with seed: " in the innocence of their admiration,
    they fabled regarding"
    ----- temperatue: 0.2
     in the innocence of their admiration,
    they fabled regarding to the self and soul, and in the most artistic faster and sources of the form of the superiority, the experience, and the superiority of the same things and superfictary of the same and soul, and the self and strong and still and sours of the most and sublime and superficman and sour and subject of the best than a profound and soul of the powerful and powerful and the same soul--in the most and d----- temperatue: 0.5
    e powerful and powerful and the same soul--in the most and deceives to the
    such and comparion of the individual proves to an a privatedy of actions of human
    responsible to my sounds of the delicate and last their higher sense of the same fashion they are things in this
    heart and there in the fact to the surple of the constitute to the tentious consist and the
    such as the most aristocrate fact or a partially, and another will be more delicately one place of----- temperatue: 1.0
     partially, and another will be more delicately one place of
    the fact understanding
    storciale unto
    hence and intentional statest philosophy compared by the derinction their metions, alonpte in some old hamment
    as ever
    beautifur forwarding, hind and grember to
    mysselitiess whom they there
    there are
    the
    knowledge, and man all these belie of
    scarcepless anew later man
    strucher minded, therefore man for in the
    relusion, the good log!--fon voubded erome?--who, ----- temperatue: 1.2
    or in the
    relusion, the good log!--fon voubded erome?--who, i keeth sen almost and fours, herely cless
    are
    has loiked without light-possible exmutetry wete around by the y"; andux "but if a hack, thourary raetary of accorual hagw
    be ha"w: no even almost, is not france puriness in this,, beffbtes; un further.
    
    17 so to tureht to ?n(theow--they, of mkeatile wrong iderable, for views of thoughts of which or inference: only himself whose bod
    even deepen. reed epoch 26
    1565/1565 [==============================] - 112s 72ms/step - loss: 1.2960
    -- Generating with seed: "n they became "patriots." i think of such men as
    napoleon, g"
    ----- temperatue: 0.2
    n they became "patriots." i think of such men as
    napoleon, grow and the man and ages of the spirit of the sense of the substraint of the sense of the act of the contrary one was a man of the sense of the spirit of the most superiority of the spirit of the consequently and in the property of the spirit and self-recolning of the spirit in the consequently the sense of the spirit and contemplation of the sense of the sense of the spirit and the sense of the s----- temperatue: 0.5
     the sense of the sense of the spirit and the sense of the same minds and for instance of the spirit states of a man of the ages and faith and contemplation of the greater look and as a distinction of superiority. there is a historical communities might of the sulties in the strong be so
    also
    that we are not deceives to the convalue of men to god.
    
    17 the interrogin of the the metaphysical man of the most historically and other most the delight of the most----- temperatue: 1.0
    the most historically and other most the delight of the most last unconstraints..-..
    
    219. the obligeness animal times benefit in a mysee
    culture over in order there has path fortictume
    that," is
    sinful power-down carraced disclass itself, it would be savition, sucliked hopes of the fittering,
    and notwitted to a strow a character
    one play but when the own sinment individual second disguises.
    
    1e to being
    sodedication of grudple, him who is propated but the----- temperatue: 1.2
    o being
    sodedication of grudple, him who is propated but the
    strangeations,
    with no. easa), what we vetar, gro somethologier disguscence in means upon
    acts drink of hratict feels namely mocepes, herebke your velfy, the untrandent as up
    toulat of the kant, suspife the indismest and
    ssensified tangate of
    hardqrimitifie to faculty. "namely be learnts, there is so an ascets all eyong, accribale--immediately being as breye""--metaphysic as half-wasd musinggesisepoch 27
     873/1565 [===============>..............] - ETA: 51s - loss: 1.2818


    ---------------------------------------------------------------------------

    KeyboardInterrupt                         Traceback (most recent call last)

    Input In [32], in <cell line: 1>()
          1 for epoch in range(1, 60):
          2     print('epoch', epoch)
    ----> 3     model.fit(x, y, batch_size=128, epochs=1)
          4     start_index = random.randint(0, len(text) - maxlen - 1)
          5     generated_text = text[start_index: start_index + maxlen]


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/keras/utils/traceback_utils.py:64, in filter_traceback.<locals>.error_handler(*args, **kwargs)
         62 filtered_tb = None
         63 try:
    ---> 64   return fn(*args, **kwargs)
         65 except Exception as e:  # pylint: disable=broad-except
         66   filtered_tb = _process_traceback_frames(e.__traceback__)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/keras/engine/training.py:1384, in Model.fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)
       1377 with tf.profiler.experimental.Trace(
       1378     'train',
       1379     epoch_num=epoch,
       1380     step_num=step,
       1381     batch_size=batch_size,
       1382     _r=1):
       1383   callbacks.on_train_batch_begin(step)
    -> 1384   tmp_logs = self.train_function(iterator)
       1385   if data_handler.should_sync:
       1386     context.async_wait()


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:150, in filter_traceback.<locals>.error_handler(*args, **kwargs)
        148 filtered_tb = None
        149 try:
    --> 150   return fn(*args, **kwargs)
        151 except Exception as e:
        152   filtered_tb = _process_traceback_frames(e.__traceback__)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/def_function.py:915, in Function.__call__(self, *args, **kwds)
        912 compiler = "xla" if self._jit_compile else "nonXla"
        914 with OptionalXlaContext(self._jit_compile):
    --> 915   result = self._call(*args, **kwds)
        917 new_tracing_count = self.experimental_get_tracing_count()
        918 without_tracing = (tracing_count == new_tracing_count)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/def_function.py:947, in Function._call(self, *args, **kwds)
        944   self._lock.release()
        945   # In this case we have created variables on the first call, so we run the
        946   # defunned version which is guaranteed to never create variables.
    --> 947   return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
        948 elif self._stateful_fn is not None:
        949   # Release the lock early so that multiple threads can perform the call
        950   # in parallel.
        951   self._lock.release()


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/function.py:2956, in Function.__call__(self, *args, **kwargs)
       2953 with self._lock:
       2954   (graph_function,
       2955    filtered_flat_args) = self._maybe_define_function(args, kwargs)
    -> 2956 return graph_function._call_flat(
       2957     filtered_flat_args, captured_inputs=graph_function.captured_inputs)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/function.py:1853, in ConcreteFunction._call_flat(self, args, captured_inputs, cancellation_manager)
       1849 possible_gradient_type = gradients_util.PossibleTapeGradientTypes(args)
       1850 if (possible_gradient_type == gradients_util.POSSIBLE_GRADIENT_TYPES_NONE
       1851     and executing_eagerly):
       1852   # No tape is watching; skip to running the function.
    -> 1853   return self._build_call_outputs(self._inference_function.call(
       1854       ctx, args, cancellation_manager=cancellation_manager))
       1855 forward_backward = self._select_forward_and_backward_functions(
       1856     args,
       1857     possible_gradient_type,
       1858     executing_eagerly)
       1859 forward_function, args_with_tangents = forward_backward.forward()


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/function.py:499, in _EagerDefinedFunction.call(self, ctx, args, cancellation_manager)
        497 with _InterpolateFunctionError(self):
        498   if cancellation_manager is None:
    --> 499     outputs = execute.execute(
        500         str(self.signature.name),
        501         num_outputs=self._num_outputs,
        502         inputs=args,
        503         attrs=attrs,
        504         ctx=ctx)
        505   else:
        506     outputs = execute.execute_with_cancellation(
        507         str(self.signature.name),
        508         num_outputs=self._num_outputs,
       (...)
        511         ctx=ctx,
        512         cancellation_manager=cancellation_manager)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/eager/execute.py:54, in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)
         52 try:
         53   ctx.ensure_initialized()
    ---> 54   tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
         55                                       inputs, attrs, num_outputs)
         56 except core._NotOkStatusException as e:
         57   if name is not None:


    KeyboardInterrupt: 


# DeepDream

## Inception模型


```python
from keras.applications import inception_v3
from keras import backend as K
# 禁用训练功能
K.set_learning_phase(0)
model = inception_v3.InceptionV3(weights='imagenet', include_top=False)
model.summary()
```

    Model: "inception_v3"
    __________________________________________________________________________________________________
     Layer (type)                   Output Shape         Param #     Connected to                     
    ==================================================================================================
     input_5 (InputLayer)           [(None, None, None,  0           []                               
                                     3)]                                                              
                                                                                                      
     conv2d_376 (Conv2D)            (None, None, None,   864         ['input_5[0][0]']                
                                    32)                                                               
                                                                                                      
     batch_normalization_376 (Batch  (None, None, None,   96         ['conv2d_376[0][0]']             
     Normalization)                 32)                                                               
                                                                                                      
     activation_376 (Activation)    (None, None, None,   0           ['batch_normalization_376[0][0]']
                                    32)                                                               
                                                                                                      
     conv2d_377 (Conv2D)            (None, None, None,   9216        ['activation_376[0][0]']         
                                    32)                                                               
                                                                                                      
     batch_normalization_377 (Batch  (None, None, None,   96         ['conv2d_377[0][0]']             
     Normalization)                 32)                                                               
                                                                                                      
     activation_377 (Activation)    (None, None, None,   0           ['batch_normalization_377[0][0]']
                                    32)                                                               
                                                                                                      
     conv2d_378 (Conv2D)            (None, None, None,   18432       ['activation_377[0][0]']         
                                    64)                                                               
                                                                                                      
     batch_normalization_378 (Batch  (None, None, None,   192        ['conv2d_378[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_378 (Activation)    (None, None, None,   0           ['batch_normalization_378[0][0]']
                                    64)                                                               
                                                                                                      
     max_pooling2d_16 (MaxPooling2D  (None, None, None,   0          ['activation_378[0][0]']         
     )                              64)                                                               
                                                                                                      
     conv2d_379 (Conv2D)            (None, None, None,   5120        ['max_pooling2d_16[0][0]']       
                                    80)                                                               
                                                                                                      
     batch_normalization_379 (Batch  (None, None, None,   240        ['conv2d_379[0][0]']             
     Normalization)                 80)                                                               
                                                                                                      
     activation_379 (Activation)    (None, None, None,   0           ['batch_normalization_379[0][0]']
                                    80)                                                               
                                                                                                      
     conv2d_380 (Conv2D)            (None, None, None,   138240      ['activation_379[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_380 (Batch  (None, None, None,   576        ['conv2d_380[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_380 (Activation)    (None, None, None,   0           ['batch_normalization_380[0][0]']
                                    192)                                                              
                                                                                                      
     max_pooling2d_17 (MaxPooling2D  (None, None, None,   0          ['activation_380[0][0]']         
     )                              192)                                                              
                                                                                                      
     conv2d_384 (Conv2D)            (None, None, None,   12288       ['max_pooling2d_17[0][0]']       
                                    64)                                                               
                                                                                                      
     batch_normalization_384 (Batch  (None, None, None,   192        ['conv2d_384[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_384 (Activation)    (None, None, None,   0           ['batch_normalization_384[0][0]']
                                    64)                                                               
                                                                                                      
     conv2d_382 (Conv2D)            (None, None, None,   9216        ['max_pooling2d_17[0][0]']       
                                    48)                                                               
                                                                                                      
     conv2d_385 (Conv2D)            (None, None, None,   55296       ['activation_384[0][0]']         
                                    96)                                                               
                                                                                                      
     batch_normalization_382 (Batch  (None, None, None,   144        ['conv2d_382[0][0]']             
     Normalization)                 48)                                                               
                                                                                                      
     batch_normalization_385 (Batch  (None, None, None,   288        ['conv2d_385[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     activation_382 (Activation)    (None, None, None,   0           ['batch_normalization_382[0][0]']
                                    48)                                                               
                                                                                                      
     activation_385 (Activation)    (None, None, None,   0           ['batch_normalization_385[0][0]']
                                    96)                                                               
                                                                                                      
     average_pooling2d_36 (AverageP  (None, None, None,   0          ['max_pooling2d_17[0][0]']       
     ooling2D)                      192)                                                              
                                                                                                      
     conv2d_381 (Conv2D)            (None, None, None,   12288       ['max_pooling2d_17[0][0]']       
                                    64)                                                               
                                                                                                      
     conv2d_383 (Conv2D)            (None, None, None,   76800       ['activation_382[0][0]']         
                                    64)                                                               
                                                                                                      
     conv2d_386 (Conv2D)            (None, None, None,   82944       ['activation_385[0][0]']         
                                    96)                                                               
                                                                                                      
     conv2d_387 (Conv2D)            (None, None, None,   6144        ['average_pooling2d_36[0][0]']   
                                    32)                                                               
                                                                                                      
     batch_normalization_381 (Batch  (None, None, None,   192        ['conv2d_381[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_383 (Batch  (None, None, None,   192        ['conv2d_383[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_386 (Batch  (None, None, None,   288        ['conv2d_386[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     batch_normalization_387 (Batch  (None, None, None,   96         ['conv2d_387[0][0]']             
     Normalization)                 32)                                                               
                                                                                                      
     activation_381 (Activation)    (None, None, None,   0           ['batch_normalization_381[0][0]']
                                    64)                                                               
                                                                                                      
     activation_383 (Activation)    (None, None, None,   0           ['batch_normalization_383[0][0]']
                                    64)                                                               
                                                                                                      
     activation_386 (Activation)    (None, None, None,   0           ['batch_normalization_386[0][0]']
                                    96)                                                               
                                                                                                      
     activation_387 (Activation)    (None, None, None,   0           ['batch_normalization_387[0][0]']
                                    32)                                                               
                                                                                                      
     mixed0 (Concatenate)           (None, None, None,   0           ['activation_381[0][0]',         
                                    256)                              'activation_383[0][0]',         
                                                                      'activation_386[0][0]',         
                                                                      'activation_387[0][0]']         
                                                                                                      
     conv2d_391 (Conv2D)            (None, None, None,   16384       ['mixed0[0][0]']                 
                                    64)                                                               
                                                                                                      
     batch_normalization_391 (Batch  (None, None, None,   192        ['conv2d_391[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_391 (Activation)    (None, None, None,   0           ['batch_normalization_391[0][0]']
                                    64)                                                               
                                                                                                      
     conv2d_389 (Conv2D)            (None, None, None,   12288       ['mixed0[0][0]']                 
                                    48)                                                               
                                                                                                      
     conv2d_392 (Conv2D)            (None, None, None,   55296       ['activation_391[0][0]']         
                                    96)                                                               
                                                                                                      
     batch_normalization_389 (Batch  (None, None, None,   144        ['conv2d_389[0][0]']             
     Normalization)                 48)                                                               
                                                                                                      
     batch_normalization_392 (Batch  (None, None, None,   288        ['conv2d_392[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     activation_389 (Activation)    (None, None, None,   0           ['batch_normalization_389[0][0]']
                                    48)                                                               
                                                                                                      
     activation_392 (Activation)    (None, None, None,   0           ['batch_normalization_392[0][0]']
                                    96)                                                               
                                                                                                      
     average_pooling2d_37 (AverageP  (None, None, None,   0          ['mixed0[0][0]']                 
     ooling2D)                      256)                                                              
                                                                                                      
     conv2d_388 (Conv2D)            (None, None, None,   16384       ['mixed0[0][0]']                 
                                    64)                                                               
                                                                                                      
     conv2d_390 (Conv2D)            (None, None, None,   76800       ['activation_389[0][0]']         
                                    64)                                                               
                                                                                                      
     conv2d_393 (Conv2D)            (None, None, None,   82944       ['activation_392[0][0]']         
                                    96)                                                               
                                                                                                      
     conv2d_394 (Conv2D)            (None, None, None,   16384       ['average_pooling2d_37[0][0]']   
                                    64)                                                               
                                                                                                      
     batch_normalization_388 (Batch  (None, None, None,   192        ['conv2d_388[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_390 (Batch  (None, None, None,   192        ['conv2d_390[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_393 (Batch  (None, None, None,   288        ['conv2d_393[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     batch_normalization_394 (Batch  (None, None, None,   192        ['conv2d_394[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_388 (Activation)    (None, None, None,   0           ['batch_normalization_388[0][0]']
                                    64)                                                               
                                                                                                      
     activation_390 (Activation)    (None, None, None,   0           ['batch_normalization_390[0][0]']
                                    64)                                                               
                                                                                                      
     activation_393 (Activation)    (None, None, None,   0           ['batch_normalization_393[0][0]']
                                    96)                                                               
                                                                                                      
     activation_394 (Activation)    (None, None, None,   0           ['batch_normalization_394[0][0]']
                                    64)                                                               
                                                                                                      
     mixed1 (Concatenate)           (None, None, None,   0           ['activation_388[0][0]',         
                                    288)                              'activation_390[0][0]',         
                                                                      'activation_393[0][0]',         
                                                                      'activation_394[0][0]']         
                                                                                                      
     conv2d_398 (Conv2D)            (None, None, None,   18432       ['mixed1[0][0]']                 
                                    64)                                                               
                                                                                                      
     batch_normalization_398 (Batch  (None, None, None,   192        ['conv2d_398[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_398 (Activation)    (None, None, None,   0           ['batch_normalization_398[0][0]']
                                    64)                                                               
                                                                                                      
     conv2d_396 (Conv2D)            (None, None, None,   13824       ['mixed1[0][0]']                 
                                    48)                                                               
                                                                                                      
     conv2d_399 (Conv2D)            (None, None, None,   55296       ['activation_398[0][0]']         
                                    96)                                                               
                                                                                                      
     batch_normalization_396 (Batch  (None, None, None,   144        ['conv2d_396[0][0]']             
     Normalization)                 48)                                                               
                                                                                                      
     batch_normalization_399 (Batch  (None, None, None,   288        ['conv2d_399[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     activation_396 (Activation)    (None, None, None,   0           ['batch_normalization_396[0][0]']
                                    48)                                                               
                                                                                                      
     activation_399 (Activation)    (None, None, None,   0           ['batch_normalization_399[0][0]']
                                    96)                                                               
                                                                                                      
     average_pooling2d_38 (AverageP  (None, None, None,   0          ['mixed1[0][0]']                 
     ooling2D)                      288)                                                              
                                                                                                      
     conv2d_395 (Conv2D)            (None, None, None,   18432       ['mixed1[0][0]']                 
                                    64)                                                               
                                                                                                      
     conv2d_397 (Conv2D)            (None, None, None,   76800       ['activation_396[0][0]']         
                                    64)                                                               
                                                                                                      
     conv2d_400 (Conv2D)            (None, None, None,   82944       ['activation_399[0][0]']         
                                    96)                                                               
                                                                                                      
     conv2d_401 (Conv2D)            (None, None, None,   18432       ['average_pooling2d_38[0][0]']   
                                    64)                                                               
                                                                                                      
     batch_normalization_395 (Batch  (None, None, None,   192        ['conv2d_395[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_397 (Batch  (None, None, None,   192        ['conv2d_397[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     batch_normalization_400 (Batch  (None, None, None,   288        ['conv2d_400[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     batch_normalization_401 (Batch  (None, None, None,   192        ['conv2d_401[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_395 (Activation)    (None, None, None,   0           ['batch_normalization_395[0][0]']
                                    64)                                                               
                                                                                                      
     activation_397 (Activation)    (None, None, None,   0           ['batch_normalization_397[0][0]']
                                    64)                                                               
                                                                                                      
     activation_400 (Activation)    (None, None, None,   0           ['batch_normalization_400[0][0]']
                                    96)                                                               
                                                                                                      
     activation_401 (Activation)    (None, None, None,   0           ['batch_normalization_401[0][0]']
                                    64)                                                               
                                                                                                      
     mixed2 (Concatenate)           (None, None, None,   0           ['activation_395[0][0]',         
                                    288)                              'activation_397[0][0]',         
                                                                      'activation_400[0][0]',         
                                                                      'activation_401[0][0]']         
                                                                                                      
     conv2d_403 (Conv2D)            (None, None, None,   18432       ['mixed2[0][0]']                 
                                    64)                                                               
                                                                                                      
     batch_normalization_403 (Batch  (None, None, None,   192        ['conv2d_403[0][0]']             
     Normalization)                 64)                                                               
                                                                                                      
     activation_403 (Activation)    (None, None, None,   0           ['batch_normalization_403[0][0]']
                                    64)                                                               
                                                                                                      
     conv2d_404 (Conv2D)            (None, None, None,   55296       ['activation_403[0][0]']         
                                    96)                                                               
                                                                                                      
     batch_normalization_404 (Batch  (None, None, None,   288        ['conv2d_404[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     activation_404 (Activation)    (None, None, None,   0           ['batch_normalization_404[0][0]']
                                    96)                                                               
                                                                                                      
     conv2d_402 (Conv2D)            (None, None, None,   995328      ['mixed2[0][0]']                 
                                    384)                                                              
                                                                                                      
     conv2d_405 (Conv2D)            (None, None, None,   82944       ['activation_404[0][0]']         
                                    96)                                                               
                                                                                                      
     batch_normalization_402 (Batch  (None, None, None,   1152       ['conv2d_402[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_405 (Batch  (None, None, None,   288        ['conv2d_405[0][0]']             
     Normalization)                 96)                                                               
                                                                                                      
     activation_402 (Activation)    (None, None, None,   0           ['batch_normalization_402[0][0]']
                                    384)                                                              
                                                                                                      
     activation_405 (Activation)    (None, None, None,   0           ['batch_normalization_405[0][0]']
                                    96)                                                               
                                                                                                      
     max_pooling2d_18 (MaxPooling2D  (None, None, None,   0          ['mixed2[0][0]']                 
     )                              288)                                                              
                                                                                                      
     mixed3 (Concatenate)           (None, None, None,   0           ['activation_402[0][0]',         
                                    768)                              'activation_405[0][0]',         
                                                                      'max_pooling2d_18[0][0]']       
                                                                                                      
     conv2d_410 (Conv2D)            (None, None, None,   98304       ['mixed3[0][0]']                 
                                    128)                                                              
                                                                                                      
     batch_normalization_410 (Batch  (None, None, None,   384        ['conv2d_410[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     activation_410 (Activation)    (None, None, None,   0           ['batch_normalization_410[0][0]']
                                    128)                                                              
                                                                                                      
     conv2d_411 (Conv2D)            (None, None, None,   114688      ['activation_410[0][0]']         
                                    128)                                                              
                                                                                                      
     batch_normalization_411 (Batch  (None, None, None,   384        ['conv2d_411[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     activation_411 (Activation)    (None, None, None,   0           ['batch_normalization_411[0][0]']
                                    128)                                                              
                                                                                                      
     conv2d_407 (Conv2D)            (None, None, None,   98304       ['mixed3[0][0]']                 
                                    128)                                                              
                                                                                                      
     conv2d_412 (Conv2D)            (None, None, None,   114688      ['activation_411[0][0]']         
                                    128)                                                              
                                                                                                      
     batch_normalization_407 (Batch  (None, None, None,   384        ['conv2d_407[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     batch_normalization_412 (Batch  (None, None, None,   384        ['conv2d_412[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     activation_407 (Activation)    (None, None, None,   0           ['batch_normalization_407[0][0]']
                                    128)                                                              
                                                                                                      
     activation_412 (Activation)    (None, None, None,   0           ['batch_normalization_412[0][0]']
                                    128)                                                              
                                                                                                      
     conv2d_408 (Conv2D)            (None, None, None,   114688      ['activation_407[0][0]']         
                                    128)                                                              
                                                                                                      
     conv2d_413 (Conv2D)            (None, None, None,   114688      ['activation_412[0][0]']         
                                    128)                                                              
                                                                                                      
     batch_normalization_408 (Batch  (None, None, None,   384        ['conv2d_408[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     batch_normalization_413 (Batch  (None, None, None,   384        ['conv2d_413[0][0]']             
     Normalization)                 128)                                                              
                                                                                                      
     activation_408 (Activation)    (None, None, None,   0           ['batch_normalization_408[0][0]']
                                    128)                                                              
                                                                                                      
     activation_413 (Activation)    (None, None, None,   0           ['batch_normalization_413[0][0]']
                                    128)                                                              
                                                                                                      
     average_pooling2d_39 (AverageP  (None, None, None,   0          ['mixed3[0][0]']                 
     ooling2D)                      768)                                                              
                                                                                                      
     conv2d_406 (Conv2D)            (None, None, None,   147456      ['mixed3[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_409 (Conv2D)            (None, None, None,   172032      ['activation_408[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_414 (Conv2D)            (None, None, None,   172032      ['activation_413[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_415 (Conv2D)            (None, None, None,   147456      ['average_pooling2d_39[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_406 (Batch  (None, None, None,   576        ['conv2d_406[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_409 (Batch  (None, None, None,   576        ['conv2d_409[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_414 (Batch  (None, None, None,   576        ['conv2d_414[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_415 (Batch  (None, None, None,   576        ['conv2d_415[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_406 (Activation)    (None, None, None,   0           ['batch_normalization_406[0][0]']
                                    192)                                                              
                                                                                                      
     activation_409 (Activation)    (None, None, None,   0           ['batch_normalization_409[0][0]']
                                    192)                                                              
                                                                                                      
     activation_414 (Activation)    (None, None, None,   0           ['batch_normalization_414[0][0]']
                                    192)                                                              
                                                                                                      
     activation_415 (Activation)    (None, None, None,   0           ['batch_normalization_415[0][0]']
                                    192)                                                              
                                                                                                      
     mixed4 (Concatenate)           (None, None, None,   0           ['activation_406[0][0]',         
                                    768)                              'activation_409[0][0]',         
                                                                      'activation_414[0][0]',         
                                                                      'activation_415[0][0]']         
                                                                                                      
     conv2d_420 (Conv2D)            (None, None, None,   122880      ['mixed4[0][0]']                 
                                    160)                                                              
                                                                                                      
     batch_normalization_420 (Batch  (None, None, None,   480        ['conv2d_420[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_420 (Activation)    (None, None, None,   0           ['batch_normalization_420[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_421 (Conv2D)            (None, None, None,   179200      ['activation_420[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_421 (Batch  (None, None, None,   480        ['conv2d_421[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_421 (Activation)    (None, None, None,   0           ['batch_normalization_421[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_417 (Conv2D)            (None, None, None,   122880      ['mixed4[0][0]']                 
                                    160)                                                              
                                                                                                      
     conv2d_422 (Conv2D)            (None, None, None,   179200      ['activation_421[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_417 (Batch  (None, None, None,   480        ['conv2d_417[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     batch_normalization_422 (Batch  (None, None, None,   480        ['conv2d_422[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_417 (Activation)    (None, None, None,   0           ['batch_normalization_417[0][0]']
                                    160)                                                              
                                                                                                      
     activation_422 (Activation)    (None, None, None,   0           ['batch_normalization_422[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_418 (Conv2D)            (None, None, None,   179200      ['activation_417[0][0]']         
                                    160)                                                              
                                                                                                      
     conv2d_423 (Conv2D)            (None, None, None,   179200      ['activation_422[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_418 (Batch  (None, None, None,   480        ['conv2d_418[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     batch_normalization_423 (Batch  (None, None, None,   480        ['conv2d_423[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_418 (Activation)    (None, None, None,   0           ['batch_normalization_418[0][0]']
                                    160)                                                              
                                                                                                      
     activation_423 (Activation)    (None, None, None,   0           ['batch_normalization_423[0][0]']
                                    160)                                                              
                                                                                                      
     average_pooling2d_40 (AverageP  (None, None, None,   0          ['mixed4[0][0]']                 
     ooling2D)                      768)                                                              
                                                                                                      
     conv2d_416 (Conv2D)            (None, None, None,   147456      ['mixed4[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_419 (Conv2D)            (None, None, None,   215040      ['activation_418[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_424 (Conv2D)            (None, None, None,   215040      ['activation_423[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_425 (Conv2D)            (None, None, None,   147456      ['average_pooling2d_40[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_416 (Batch  (None, None, None,   576        ['conv2d_416[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_419 (Batch  (None, None, None,   576        ['conv2d_419[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_424 (Batch  (None, None, None,   576        ['conv2d_424[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_425 (Batch  (None, None, None,   576        ['conv2d_425[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_416 (Activation)    (None, None, None,   0           ['batch_normalization_416[0][0]']
                                    192)                                                              
                                                                                                      
     activation_419 (Activation)    (None, None, None,   0           ['batch_normalization_419[0][0]']
                                    192)                                                              
                                                                                                      
     activation_424 (Activation)    (None, None, None,   0           ['batch_normalization_424[0][0]']
                                    192)                                                              
                                                                                                      
     activation_425 (Activation)    (None, None, None,   0           ['batch_normalization_425[0][0]']
                                    192)                                                              
                                                                                                      
     mixed5 (Concatenate)           (None, None, None,   0           ['activation_416[0][0]',         
                                    768)                              'activation_419[0][0]',         
                                                                      'activation_424[0][0]',         
                                                                      'activation_425[0][0]']         
                                                                                                      
     conv2d_430 (Conv2D)            (None, None, None,   122880      ['mixed5[0][0]']                 
                                    160)                                                              
                                                                                                      
     batch_normalization_430 (Batch  (None, None, None,   480        ['conv2d_430[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_430 (Activation)    (None, None, None,   0           ['batch_normalization_430[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_431 (Conv2D)            (None, None, None,   179200      ['activation_430[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_431 (Batch  (None, None, None,   480        ['conv2d_431[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_431 (Activation)    (None, None, None,   0           ['batch_normalization_431[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_427 (Conv2D)            (None, None, None,   122880      ['mixed5[0][0]']                 
                                    160)                                                              
                                                                                                      
     conv2d_432 (Conv2D)            (None, None, None,   179200      ['activation_431[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_427 (Batch  (None, None, None,   480        ['conv2d_427[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     batch_normalization_432 (Batch  (None, None, None,   480        ['conv2d_432[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_427 (Activation)    (None, None, None,   0           ['batch_normalization_427[0][0]']
                                    160)                                                              
                                                                                                      
     activation_432 (Activation)    (None, None, None,   0           ['batch_normalization_432[0][0]']
                                    160)                                                              
                                                                                                      
     conv2d_428 (Conv2D)            (None, None, None,   179200      ['activation_427[0][0]']         
                                    160)                                                              
                                                                                                      
     conv2d_433 (Conv2D)            (None, None, None,   179200      ['activation_432[0][0]']         
                                    160)                                                              
                                                                                                      
     batch_normalization_428 (Batch  (None, None, None,   480        ['conv2d_428[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     batch_normalization_433 (Batch  (None, None, None,   480        ['conv2d_433[0][0]']             
     Normalization)                 160)                                                              
                                                                                                      
     activation_428 (Activation)    (None, None, None,   0           ['batch_normalization_428[0][0]']
                                    160)                                                              
                                                                                                      
     activation_433 (Activation)    (None, None, None,   0           ['batch_normalization_433[0][0]']
                                    160)                                                              
                                                                                                      
     average_pooling2d_41 (AverageP  (None, None, None,   0          ['mixed5[0][0]']                 
     ooling2D)                      768)                                                              
                                                                                                      
     conv2d_426 (Conv2D)            (None, None, None,   147456      ['mixed5[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_429 (Conv2D)            (None, None, None,   215040      ['activation_428[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_434 (Conv2D)            (None, None, None,   215040      ['activation_433[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_435 (Conv2D)            (None, None, None,   147456      ['average_pooling2d_41[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_426 (Batch  (None, None, None,   576        ['conv2d_426[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_429 (Batch  (None, None, None,   576        ['conv2d_429[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_434 (Batch  (None, None, None,   576        ['conv2d_434[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_435 (Batch  (None, None, None,   576        ['conv2d_435[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_426 (Activation)    (None, None, None,   0           ['batch_normalization_426[0][0]']
                                    192)                                                              
                                                                                                      
     activation_429 (Activation)    (None, None, None,   0           ['batch_normalization_429[0][0]']
                                    192)                                                              
                                                                                                      
     activation_434 (Activation)    (None, None, None,   0           ['batch_normalization_434[0][0]']
                                    192)                                                              
                                                                                                      
     activation_435 (Activation)    (None, None, None,   0           ['batch_normalization_435[0][0]']
                                    192)                                                              
                                                                                                      
     mixed6 (Concatenate)           (None, None, None,   0           ['activation_426[0][0]',         
                                    768)                              'activation_429[0][0]',         
                                                                      'activation_434[0][0]',         
                                                                      'activation_435[0][0]']         
                                                                                                      
     conv2d_440 (Conv2D)            (None, None, None,   147456      ['mixed6[0][0]']                 
                                    192)                                                              
                                                                                                      
     batch_normalization_440 (Batch  (None, None, None,   576        ['conv2d_440[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_440 (Activation)    (None, None, None,   0           ['batch_normalization_440[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_441 (Conv2D)            (None, None, None,   258048      ['activation_440[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_441 (Batch  (None, None, None,   576        ['conv2d_441[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_441 (Activation)    (None, None, None,   0           ['batch_normalization_441[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_437 (Conv2D)            (None, None, None,   147456      ['mixed6[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_442 (Conv2D)            (None, None, None,   258048      ['activation_441[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_437 (Batch  (None, None, None,   576        ['conv2d_437[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_442 (Batch  (None, None, None,   576        ['conv2d_442[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_437 (Activation)    (None, None, None,   0           ['batch_normalization_437[0][0]']
                                    192)                                                              
                                                                                                      
     activation_442 (Activation)    (None, None, None,   0           ['batch_normalization_442[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_438 (Conv2D)            (None, None, None,   258048      ['activation_437[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_443 (Conv2D)            (None, None, None,   258048      ['activation_442[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_438 (Batch  (None, None, None,   576        ['conv2d_438[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_443 (Batch  (None, None, None,   576        ['conv2d_443[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_438 (Activation)    (None, None, None,   0           ['batch_normalization_438[0][0]']
                                    192)                                                              
                                                                                                      
     activation_443 (Activation)    (None, None, None,   0           ['batch_normalization_443[0][0]']
                                    192)                                                              
                                                                                                      
     average_pooling2d_42 (AverageP  (None, None, None,   0          ['mixed6[0][0]']                 
     ooling2D)                      768)                                                              
                                                                                                      
     conv2d_436 (Conv2D)            (None, None, None,   147456      ['mixed6[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_439 (Conv2D)            (None, None, None,   258048      ['activation_438[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_444 (Conv2D)            (None, None, None,   258048      ['activation_443[0][0]']         
                                    192)                                                              
                                                                                                      
     conv2d_445 (Conv2D)            (None, None, None,   147456      ['average_pooling2d_42[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_436 (Batch  (None, None, None,   576        ['conv2d_436[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_439 (Batch  (None, None, None,   576        ['conv2d_439[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_444 (Batch  (None, None, None,   576        ['conv2d_444[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_445 (Batch  (None, None, None,   576        ['conv2d_445[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_436 (Activation)    (None, None, None,   0           ['batch_normalization_436[0][0]']
                                    192)                                                              
                                                                                                      
     activation_439 (Activation)    (None, None, None,   0           ['batch_normalization_439[0][0]']
                                    192)                                                              
                                                                                                      
     activation_444 (Activation)    (None, None, None,   0           ['batch_normalization_444[0][0]']
                                    192)                                                              
                                                                                                      
     activation_445 (Activation)    (None, None, None,   0           ['batch_normalization_445[0][0]']
                                    192)                                                              
                                                                                                      
     mixed7 (Concatenate)           (None, None, None,   0           ['activation_436[0][0]',         
                                    768)                              'activation_439[0][0]',         
                                                                      'activation_444[0][0]',         
                                                                      'activation_445[0][0]']         
                                                                                                      
     conv2d_448 (Conv2D)            (None, None, None,   147456      ['mixed7[0][0]']                 
                                    192)                                                              
                                                                                                      
     batch_normalization_448 (Batch  (None, None, None,   576        ['conv2d_448[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_448 (Activation)    (None, None, None,   0           ['batch_normalization_448[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_449 (Conv2D)            (None, None, None,   258048      ['activation_448[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_449 (Batch  (None, None, None,   576        ['conv2d_449[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_449 (Activation)    (None, None, None,   0           ['batch_normalization_449[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_446 (Conv2D)            (None, None, None,   147456      ['mixed7[0][0]']                 
                                    192)                                                              
                                                                                                      
     conv2d_450 (Conv2D)            (None, None, None,   258048      ['activation_449[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_446 (Batch  (None, None, None,   576        ['conv2d_446[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     batch_normalization_450 (Batch  (None, None, None,   576        ['conv2d_450[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_446 (Activation)    (None, None, None,   0           ['batch_normalization_446[0][0]']
                                    192)                                                              
                                                                                                      
     activation_450 (Activation)    (None, None, None,   0           ['batch_normalization_450[0][0]']
                                    192)                                                              
                                                                                                      
     conv2d_447 (Conv2D)            (None, None, None,   552960      ['activation_446[0][0]']         
                                    320)                                                              
                                                                                                      
     conv2d_451 (Conv2D)            (None, None, None,   331776      ['activation_450[0][0]']         
                                    192)                                                              
                                                                                                      
     batch_normalization_447 (Batch  (None, None, None,   960        ['conv2d_447[0][0]']             
     Normalization)                 320)                                                              
                                                                                                      
     batch_normalization_451 (Batch  (None, None, None,   576        ['conv2d_451[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_447 (Activation)    (None, None, None,   0           ['batch_normalization_447[0][0]']
                                    320)                                                              
                                                                                                      
     activation_451 (Activation)    (None, None, None,   0           ['batch_normalization_451[0][0]']
                                    192)                                                              
                                                                                                      
     max_pooling2d_19 (MaxPooling2D  (None, None, None,   0          ['mixed7[0][0]']                 
     )                              768)                                                              
                                                                                                      
     mixed8 (Concatenate)           (None, None, None,   0           ['activation_447[0][0]',         
                                    1280)                             'activation_451[0][0]',         
                                                                      'max_pooling2d_19[0][0]']       
                                                                                                      
     conv2d_456 (Conv2D)            (None, None, None,   573440      ['mixed8[0][0]']                 
                                    448)                                                              
                                                                                                      
     batch_normalization_456 (Batch  (None, None, None,   1344       ['conv2d_456[0][0]']             
     Normalization)                 448)                                                              
                                                                                                      
     activation_456 (Activation)    (None, None, None,   0           ['batch_normalization_456[0][0]']
                                    448)                                                              
                                                                                                      
     conv2d_453 (Conv2D)            (None, None, None,   491520      ['mixed8[0][0]']                 
                                    384)                                                              
                                                                                                      
     conv2d_457 (Conv2D)            (None, None, None,   1548288     ['activation_456[0][0]']         
                                    384)                                                              
                                                                                                      
     batch_normalization_453 (Batch  (None, None, None,   1152       ['conv2d_453[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_457 (Batch  (None, None, None,   1152       ['conv2d_457[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     activation_453 (Activation)    (None, None, None,   0           ['batch_normalization_453[0][0]']
                                    384)                                                              
                                                                                                      
     activation_457 (Activation)    (None, None, None,   0           ['batch_normalization_457[0][0]']
                                    384)                                                              
                                                                                                      
     conv2d_454 (Conv2D)            (None, None, None,   442368      ['activation_453[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_455 (Conv2D)            (None, None, None,   442368      ['activation_453[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_458 (Conv2D)            (None, None, None,   442368      ['activation_457[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_459 (Conv2D)            (None, None, None,   442368      ['activation_457[0][0]']         
                                    384)                                                              
                                                                                                      
     average_pooling2d_43 (AverageP  (None, None, None,   0          ['mixed8[0][0]']                 
     ooling2D)                      1280)                                                             
                                                                                                      
     conv2d_452 (Conv2D)            (None, None, None,   409600      ['mixed8[0][0]']                 
                                    320)                                                              
                                                                                                      
     batch_normalization_454 (Batch  (None, None, None,   1152       ['conv2d_454[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_455 (Batch  (None, None, None,   1152       ['conv2d_455[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_458 (Batch  (None, None, None,   1152       ['conv2d_458[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_459 (Batch  (None, None, None,   1152       ['conv2d_459[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     conv2d_460 (Conv2D)            (None, None, None,   245760      ['average_pooling2d_43[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_452 (Batch  (None, None, None,   960        ['conv2d_452[0][0]']             
     Normalization)                 320)                                                              
                                                                                                      
     activation_454 (Activation)    (None, None, None,   0           ['batch_normalization_454[0][0]']
                                    384)                                                              
                                                                                                      
     activation_455 (Activation)    (None, None, None,   0           ['batch_normalization_455[0][0]']
                                    384)                                                              
                                                                                                      
     activation_458 (Activation)    (None, None, None,   0           ['batch_normalization_458[0][0]']
                                    384)                                                              
                                                                                                      
     activation_459 (Activation)    (None, None, None,   0           ['batch_normalization_459[0][0]']
                                    384)                                                              
                                                                                                      
     batch_normalization_460 (Batch  (None, None, None,   576        ['conv2d_460[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_452 (Activation)    (None, None, None,   0           ['batch_normalization_452[0][0]']
                                    320)                                                              
                                                                                                      
     mixed9_0 (Concatenate)         (None, None, None,   0           ['activation_454[0][0]',         
                                    768)                              'activation_455[0][0]']         
                                                                                                      
     concatenate_8 (Concatenate)    (None, None, None,   0           ['activation_458[0][0]',         
                                    768)                              'activation_459[0][0]']         
                                                                                                      
     activation_460 (Activation)    (None, None, None,   0           ['batch_normalization_460[0][0]']
                                    192)                                                              
                                                                                                      
     mixed9 (Concatenate)           (None, None, None,   0           ['activation_452[0][0]',         
                                    2048)                             'mixed9_0[0][0]',               
                                                                      'concatenate_8[0][0]',          
                                                                      'activation_460[0][0]']         
                                                                                                      
     conv2d_465 (Conv2D)            (None, None, None,   917504      ['mixed9[0][0]']                 
                                    448)                                                              
                                                                                                      
     batch_normalization_465 (Batch  (None, None, None,   1344       ['conv2d_465[0][0]']             
     Normalization)                 448)                                                              
                                                                                                      
     activation_465 (Activation)    (None, None, None,   0           ['batch_normalization_465[0][0]']
                                    448)                                                              
                                                                                                      
     conv2d_462 (Conv2D)            (None, None, None,   786432      ['mixed9[0][0]']                 
                                    384)                                                              
                                                                                                      
     conv2d_466 (Conv2D)            (None, None, None,   1548288     ['activation_465[0][0]']         
                                    384)                                                              
                                                                                                      
     batch_normalization_462 (Batch  (None, None, None,   1152       ['conv2d_462[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_466 (Batch  (None, None, None,   1152       ['conv2d_466[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     activation_462 (Activation)    (None, None, None,   0           ['batch_normalization_462[0][0]']
                                    384)                                                              
                                                                                                      
     activation_466 (Activation)    (None, None, None,   0           ['batch_normalization_466[0][0]']
                                    384)                                                              
                                                                                                      
     conv2d_463 (Conv2D)            (None, None, None,   442368      ['activation_462[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_464 (Conv2D)            (None, None, None,   442368      ['activation_462[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_467 (Conv2D)            (None, None, None,   442368      ['activation_466[0][0]']         
                                    384)                                                              
                                                                                                      
     conv2d_468 (Conv2D)            (None, None, None,   442368      ['activation_466[0][0]']         
                                    384)                                                              
                                                                                                      
     average_pooling2d_44 (AverageP  (None, None, None,   0          ['mixed9[0][0]']                 
     ooling2D)                      2048)                                                             
                                                                                                      
     conv2d_461 (Conv2D)            (None, None, None,   655360      ['mixed9[0][0]']                 
                                    320)                                                              
                                                                                                      
     batch_normalization_463 (Batch  (None, None, None,   1152       ['conv2d_463[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_464 (Batch  (None, None, None,   1152       ['conv2d_464[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_467 (Batch  (None, None, None,   1152       ['conv2d_467[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     batch_normalization_468 (Batch  (None, None, None,   1152       ['conv2d_468[0][0]']             
     Normalization)                 384)                                                              
                                                                                                      
     conv2d_469 (Conv2D)            (None, None, None,   393216      ['average_pooling2d_44[0][0]']   
                                    192)                                                              
                                                                                                      
     batch_normalization_461 (Batch  (None, None, None,   960        ['conv2d_461[0][0]']             
     Normalization)                 320)                                                              
                                                                                                      
     activation_463 (Activation)    (None, None, None,   0           ['batch_normalization_463[0][0]']
                                    384)                                                              
                                                                                                      
     activation_464 (Activation)    (None, None, None,   0           ['batch_normalization_464[0][0]']
                                    384)                                                              
                                                                                                      
     activation_467 (Activation)    (None, None, None,   0           ['batch_normalization_467[0][0]']
                                    384)                                                              
                                                                                                      
     activation_468 (Activation)    (None, None, None,   0           ['batch_normalization_468[0][0]']
                                    384)                                                              
                                                                                                      
     batch_normalization_469 (Batch  (None, None, None,   576        ['conv2d_469[0][0]']             
     Normalization)                 192)                                                              
                                                                                                      
     activation_461 (Activation)    (None, None, None,   0           ['batch_normalization_461[0][0]']
                                    320)                                                              
                                                                                                      
     mixed9_1 (Concatenate)         (None, None, None,   0           ['activation_463[0][0]',         
                                    768)                              'activation_464[0][0]']         
                                                                                                      
     concatenate_9 (Concatenate)    (None, None, None,   0           ['activation_467[0][0]',         
                                    768)                              'activation_468[0][0]']         
                                                                                                      
     activation_469 (Activation)    (None, None, None,   0           ['batch_normalization_469[0][0]']
                                    192)                                                              
                                                                                                      
     mixed10 (Concatenate)          (None, None, None,   0           ['activation_461[0][0]',         
                                    2048)                             'mixed9_1[0][0]',               
                                                                      'concatenate_9[0][0]',          
                                                                      'activation_469[0][0]']         
                                                                                                      
    ==================================================================================================
    Total params: 21,802,784
    Trainable params: 21,768,352
    Non-trainable params: 34,432
    __________________________________________________________________________________________________


## 层与贡献 


```python
layer_contributions= {
    'mixed2': 0.2,
    'mixed3': 3.,
    'mixed4': 2.,
    'mixed5': 1.5,
}
```

## 损失


```python
# 字典：keys层名values层实例
layer_dict = dict([(layer.name, layer) for layer in model.layers])
# 标量，装层的贡献
loss = K.variable(0.)
# 返回keys有贡献的层名
for layer_name in layer_contributions:
    # 对应层贡献系数
    coeff = layer_contributions[layer_name]
    # 各层的激活
    activation = layer_dict[layer_name].output
    
    # l2范数添加到损失
    scaling = K.prod(K.cast(K.shape(activation), 'float32'))
    loss = loss + coeff * K.sum(K.square(activation[:, 2: -2, 2: -2, :])) / scaling
```

## 梯度上升


```python
from keras import backend as K
import tensorflow as tf
tf.compat.v1.disable_eager_execution()
```


```python
import tensorflow as tf
tf.compat.v1.disable_eager_execution()
dream = model.input
grads = K.gradients(loss, dream)[0]
grads /= K.maximum(K.mean(K.abs(grads)), 1e-7)
outputs = [loss, grads]
fetch_loss_and_grads = K.function([dream], outputs)
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    Input In [56], in <cell line: 4>()
          2 tf.compat.v1.disable_eager_execution()
          3 dream = model.input
    ----> 4 grads = K.gradients(loss, dream)[0]
          5 grads /= K.maximum(K.mean(K.abs(grads)), 1e-7)
          6 outputs = [loss, grads]


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/keras/backend.py:4352, in gradients(loss, variables)
       4340 @keras_export('keras.backend.gradients')
       4341 @doc_controls.do_not_generate_docs
       4342 def gradients(loss, variables):
       4343   """Returns the gradients of `loss` w.r.t. `variables`.
       4344 
       4345   Args:
       (...)
       4350       A gradients tensor.
       4351   """
    -> 4352   return tf.compat.v1.gradients(
       4353       loss, variables, colocate_gradients_with_ops=True)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/ops/gradients_impl.py:165, in gradients(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients, unconnected_gradients)
        160 # Creating the gradient graph for control flow mutates Operations.
        161 # _mutation_lock ensures a Session.run call cannot occur between creating and
        162 # mutating new ops.
        163 # pylint: disable=protected-access
        164 with ops.get_default_graph()._mutation_lock():
    --> 165   return gradients_util._GradientsHelper(
        166       ys, xs, grad_ys, name, colocate_gradients_with_ops,
        167       gate_gradients, aggregation_method, stop_gradients,
        168       unconnected_gradients)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/ops/gradients_util.py:515, in _GradientsHelper(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients, unconnected_gradients, src_graph)
        509 with ops.name_scope(
        510     name, "gradients",
        511     list(ys) + list(xs) + list(stop_gradients) + list(grad_ys)) as grad_scope:
        512   # Get a uid for this call to gradients that can be used to help
        513   # cluster ops for compilation.
        514   gradient_uid = ops.get_default_graph().unique_name("uid")
    --> 515   ys = ops.convert_n_to_tensor_or_indexed_slices(ys, name="y")
        516   xs = [
        517       x.handle if resource_variable_ops.is_resource_variable(x) else x
        518       for x in xs
        519   ]
        520   xs = ops.internal_convert_n_to_tensor_or_indexed_slices(
        521       xs, name="x", as_ref=True)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/indexed_slices.py:394, in convert_n_to_tensor_or_indexed_slices(values, dtype, name)
        371 def convert_n_to_tensor_or_indexed_slices(values, dtype=None, name=None):
        372   """Converts `values` to a list of `Output` or `IndexedSlices` objects.
        373 
        374   Any `IndexedSlices` or `SparseTensor` objects in `values` are returned
       (...)
        392       value.
        393   """
    --> 394   return internal_convert_n_to_tensor_or_indexed_slices(
        395       values=values, dtype=dtype, name=name, as_ref=False)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/indexed_slices.py:366, in internal_convert_n_to_tensor_or_indexed_slices(values, dtype, name, as_ref)
        363   else:
        364     n = None if name is None else "%s_%d" % (name, i)
        365     ret.append(
    --> 366         internal_convert_to_tensor_or_indexed_slices(
        367             value, dtype=dtype, name=n, as_ref=as_ref))
        368 return ret


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/indexed_slices.py:327, in internal_convert_to_tensor_or_indexed_slices(value, dtype, name, as_ref)
        325   return value
        326 else:
    --> 327   return ops.convert_to_tensor(value, dtype=dtype, name=name, as_ref=as_ref)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py:183, in trace_wrapper.<locals>.inner_wrapper.<locals>.wrapped(*args, **kwargs)
        181   with Trace(trace_name, **trace_kwargs):
        182     return func(*args, **kwargs)
    --> 183 return func(*args, **kwargs)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/ops.py:1695, in convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, dtype_hint, ctx, accepted_result_types)
       1690       raise TypeError("convert_to_tensor did not convert to "
       1691                       "the preferred dtype: %s vs %s " %
       1692                       (ret.dtype.base_dtype, preferred_dtype.base_dtype))
       1694 if ret is None:
    -> 1695   ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
       1697 if ret is NotImplemented:
       1698   continue


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py:343, in _constant_tensor_conversion_function(v, dtype, name, as_ref)
        340 def _constant_tensor_conversion_function(v, dtype=None, name=None,
        341                                          as_ref=False):
        342   _ = as_ref
    --> 343   return constant(v, dtype=dtype, name=name)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py:267, in constant(value, dtype, shape, name)
        170 @tf_export("constant", v1=[])
        171 def constant(value, dtype=None, shape=None, name="Const"):
        172   """Creates a constant tensor from a tensor-like object.
        173 
        174   Note: All eager `tf.Tensor` values are immutable (in contrast to
       (...)
        265     ValueError: if called on a symbolic tensor.
        266   """
    --> 267   return _constant_impl(value, dtype, shape, name, verify_shape=False,
        268                         allow_broadcast=True)


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py:284, in _constant_impl(value, dtype, shape, name, verify_shape, allow_broadcast)
        281 g = ops.get_default_graph()
        282 tensor_value = attr_value_pb2.AttrValue()
        283 tensor_value.tensor.CopyFrom(
    --> 284     tensor_util.make_tensor_proto(
        285         value, dtype=dtype, shape=shape, verify_shape=verify_shape,
        286         allow_broadcast=allow_broadcast))
        287 dtype_value = attr_value_pb2.AttrValue(type=tensor_value.tensor.dtype)
        288 attrs = {"value": tensor_value, "dtype": dtype_value}


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/tensorflow/python/framework/tensor_util.py:431, in make_tensor_proto(values, dtype, shape, verify_shape, allow_broadcast)
        424 is_quantized = (
        425     dtype in [
        426         dtypes.qint8, dtypes.quint8, dtypes.qint16, dtypes.quint16,
        427         dtypes.qint32
        428     ])
        430 if _is_array_like(values):
    --> 431   values = np.asarray(values)
        433 # We first convert value to a numpy array or scalar.
        434 if isinstance(values, (np.ndarray, np.generic)):


    File ~/miniforge3/envs/dl/lib/python3.10/site-packages/keras/engine/keras_tensor.py:254, in KerasTensor.__array__(self, dtype)
        253 def __array__(self, dtype=None):
    --> 254   raise TypeError(
        255       f'You are passing {self}, an intermediate Keras symbolic input/output, '
        256       'to a TF API that does not allow registering custom dispatchers, such '
        257       'as `tf.cond`, `tf.function`, gradient tapes, or `tf.map_fn`. '
        258       'Keras Functional model construction only supports '
        259       'TF API calls that *do* support dispatching, such as `tf.math.add` or '
        260       '`tf.reshape`. '
        261       'Other APIs cannot be called directly on symbolic Keras'
        262       'inputs/outputs. You can work around '
        263       'this limitation by putting the operation in a custom Keras layer '
        264       '`call` and calling that layer '
        265       'on this symbolic input/output.')


    TypeError: You are passing KerasTensor(type_spec=TensorSpec(shape=(), dtype=tf.float32, name=None), name='tf.__operators__.add_3/AddV2:0', description="created by layer 'tf.__operators__.add_3'"), an intermediate Keras symbolic input/output, to a TF API that does not allow registering custom dispatchers, such as `tf.cond`, `tf.function`, gradient tapes, or `tf.map_fn`. Keras Functional model construction only supports TF API calls that *do* support dispatching, such as `tf.math.add` or `tf.reshape`. Other APIs cannot be called directly on symbolic Kerasinputs/outputs. You can work around this limitation by putting the operation in a custom Keras layer `call` and calling that layer on this symbolic input/output.



```python

```
